!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var r in a)("object"==typeof exports?exports:e)[r]=a[r]}}(this,function(){return function(e){function t(r){if(a[r])return a[r].exports;var o=a[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var a={};return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,a){!function(){"use strict";var e=angular.module("baseapp",["ngAnimate","ui.bootstrap","ui.router","ngSanitize","uiSwitch"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,a){t.otherwise("/hbr-selfie"),a.html5Mode(!0),e.state("home",{abstract:!0,url:"/hbr-selfie/",templateUrl:"./hbr-selfie/dist/routes/home/home.template.html",data:{title:"hbr-selfie",requireAuth:!1},controller:"homeCtrl",controllerAs:"home"}).state("home.login",{url:"",templateUrl:"./hbr-selfie/dist/routes/login/login.template.html",data:{title:"Ingresar",requireAuth:!1},controller:"loginCtrl",controllerAs:"login"}).state("home.register",{url:"register",templateUrl:"./hbr-selfie/dist/routes/register/register.template.html",data:{title:"Registrar",requireAuth:!1},controller:"registerCtrl",controllerAs:"register"}).state("dashboard",{url:"/hbr-selfie/dashboard",params:{isAdmin:0,clientType:"0"},templateUrl:"./hbr-selfie/dist/routes/dashboard/dashboard.template.html",data:{title:"Dashboard",requireAuth:!0},controller:"dashboardCtrl",controllerAs:"dashboard"}).state("dashboard.comming_soon",{url:"/comming-soon",templateUrl:"./hbr-selfie/dist/routes/comming_soon/comming_soon.template.html",data:{title:"Comming Soon",requireAuth:!0},controller:"commingSoonCtrl",controllerAs:"commingSoon"}).state("dashboard.profile",{url:"/profile",templateUrl:"./hbr-selfie/dist/routes/profile/profile.template.html",data:{title:"Perfil",requireAuth:!0},controller:"profileCtrl",controllerAs:"profile"}).state("dashboard.shopping",{url:"/shopping",cache:!1,params:{venta:null},templateUrl:"./hbr-selfie/dist/routes/shopping/shopping.template.html",data:{title:"Comprar",requireAuth:!0},controller:"shoppingCtrl",controllerAs:"shopping"}).state("dashboard.shopping_list",{url:"/shopping/list",templateUrl:"./hbr-selfie/dist/routes/shopping_list/shopping_list.template.html",data:{title:"Lista de compras",requireAuth:!0},controller:"shoppingListCtrl",controllerAs:"shoppingList"}).state("dashboard.checkout",{url:"/shopping/checkout",params:{paymentGatewayUrl:null},templateUrl:"./hbr-selfie/dist/routes/checkout/checkout.template.html",data:{title:"Checkout",requireAuth:!0},controller:"checkoutCtrl",controllerAs:"checkout"}).state("dashboard.success",{url:"/shopping/checkout/success/:token",templateUrl:"./hbr-selfie/dist/routes/success/success.template.html",data:{title:"Pago Exitoso",requireAuth:!0},controller:"successCtrl",controllerAs:"success"}).state("dashboard.error",{url:"/shopping/checkout/error",templateUrl:"./hbr-selfie/dist/routes/error/error.template.html",data:{title:"Error",requireAuth:!0},controller:"errorCtrl",controllerAs:"error"}).state("dashboard.users",{url:"/usuarios",params:{client_type:0},templateUrl:"./hbr-selfie/dist/routes/users/users.template.html",data:{title:"Users",requireAuth:!0},controller:"usersCtrl",controllerAs:"users"}).state("dashboard.business",{url:"/empresas",params:{client_type:1},templateUrl:"./hbr-selfie/dist/routes/users/users.template.html",data:{title:"Companies",requireAuth:!0},controller:"usersCtrl",controllerAs:"users"}).state("dashboard.warehouse",{url:"/warehouse",templateUrl:"./hbr-selfie/dist/routes/warehouse/warehouse.template.html",data:{title:"warehouse",requireAuth:!0},controller:"warehouseCtrl",controllerAs:"warehouses"}).state("dashboard.products",{url:"/productos",templateUrl:"./hbr-selfie/dist/routes/products/products.template.html",data:{title:"Productos",requireAuth:!0},controller:"productCtrl",controllerAs:"products"}).state("dashboard.categories",{url:"/categorias",templateUrl:"./hbr-selfie/dist/routes/categories/categories.template.html",data:{title:"Categorias",requireAuth:!0},controller:"categoryCtrl",controllerAs:"categories"}).state("dashboard.manage_awb",{url:"/airway-bills",templateUrl:"./hbr-selfie/dist/routes/airwayBills/airwaybills.template.html",data:{title:"Airway Bills",requireAuth:!0},controller:"airwayCtrl",controllerAs:"airway"}).state("dashboard.airwaybill_list",{url:"/airway/list",templateUrl:"./hbr-selfie/dist/routes/airwaybill_list/airwaybill_list.template.html",data:{title:"Ver Guias",requireAuth:!0},controller:"airwayListCtrl",controllerAs:"airwayList"}).state("dashboard.process_payments",{url:"/pagos",templateUrl:"./hbr-selfie/dist/routes/process_payments/process_payments.template.html",data:{title:"Procesar Pagos",requireAuth:!0},controller:"processPaymentsCtrl",controllerAs:"processPayments"}).state("dashboard.stock_rooms",{url:"/stock-rooms",params:{boxId:null,spBoxId:null,tracking:null},templateUrl:"./hbr-selfie/dist/routes/wh-box/stock-rooms/stock-rooms.template.html",data:{title:"Stock Rooms",requireAuth:!0},controller:"stockRoomsCtrl",controllerAs:"stockRooms"}).state("dashboard.awb-box",{url:"/awb-box",params:{awbId:null},templateUrl:"./hbr-selfie/dist/routes/wh-box/awb-box/awb-box.template.html",data:{title:"Box Airway bill",requireAuth:!0},controller:"awbBoxCtrl",controllerAs:"awb"}).state("dashboard.history",{url:"/history",templateUrl:"./hbr-selfie/dist/routes/wh-box/history/history.template.html",data:{title:"History",requireAuth:!0},controller:"historyCtrl",controllerAs:"history"}).state("dashboard.shipping",{url:"/shipping",templateUrl:"./hbr-selfie/dist/routes/wh-box/shipping/shipping.template.html",data:{title:"Shipping Page",requireAuth:!0},controller:"shippingCtrl",controllerAs:"shipping"})}]).run(["$rootScope","$state","$http","$stateParams","authenticationService",function(e,t,a,r,o){var i=localStorage.getItem("lang");e.setLang=function(e){return e&&"es"!=e?"en"==e?a.get("./hbr-selfie/dist/i18n.en.json"):void 0:a.get("./hbr-selfie/dist/i18n.es.json")},e.setLang(i).then(function(t){e.langs=t.data}),e.$state=t,e.$stateParams=r,e.showSpinner=!1,e.$on("$stateChangeStart",function(t,a,r,o,i){e.showSpinner=!0}),e.$on("$stateChangeSuccess",function(a,r,i,n,s){e.showSpinner=!1,r.data.requireAuth?o.checkAuth().then(function(e){e.data.isLogged||t.go("home.login")}):"home"!=r.name&&"home.login"!=r.name||o.checkAuth().then(function(e){e.data.isLogged&&t.go("dashboard")})})}]);e.filter("start",function(){return function(e,t){if(e&&e.length)return t=+t,e.slice(t)}}),a(1)(angular,e),a(2)(angular,e),a(3)(angular,e),a(4)(angular,e),a(5)(angular,e),a(6)(angular,e),a(7)(angular,e),a(8)(angular,e),a(9)(angular,e),a(10)(angular,e),a(11)(angular,e),a(12)(angular,e),a(13)(angular,e),a(14)(angular,e),a(15)(angular,e),a(16)(angular,e),a(17)(angular,e),a(18)(angular,e),a(19)(angular,e),a(20)(angular,e),a(21)(angular,e),a(22)(angular,e),a(23)(angular,e),a(24)(angular,e),a(25)(angular,e),a(26)(angular,e),a(27)(angular,e),a(28)(angular,e),a(29)(angular,e),a(30)(angular,e),a(31)(angular,e),a(32)(angular,e),a(33)(angular,e),a(34)(angular,e)}()},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t){!function(){t.ShowSpinner=!1}()}t.controller("homeCtrl",a),a.$inject=["$http","$rootScope"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o){function i(){o.showSpinner=!0;sessionStorage.getItem("lang");r.login(n.user).then(function(e){e.data.errors?(n.loginError=e.data.errors.loginError,n.loginForm.username.$invalid=!0,n.loginForm.password.$invalid=!0,n.loginForm.$invalid=!0,o.showSpinner=!1):(sessionStorage.setItem("lang",e.data.lang),sessionStorage.setItem("sskey",e.data.sskey),sessionStorage.setItem("isAdmin",e.data.isAdmin),sessionStorage.setItem("clientType",e.data.client_type),sessionStorage.setItem("clientType",e.data.client_type),e.data.company_name||e.data.warehouse_name?sessionStorage.username=e.data.company_name||e.data.warehouse_name:sessionStorage.username=e.data.name+" "+e.data.lastname,n.loginForm.username.$invalid=!1,n.loginForm.username.$valid=!0,n.loginForm.password.$invalid=!1,n.loginForm.password.$valid=!0,n.loginForm.$invalid=!1,n.loginForm.$valid=!0,o.showSpinner=!1,setTimeout(function(){sessionStorage.getItem("sskey")&&a.go("dashboard")},100))}).catch(function(e){console.log(e)})}var n=this;!function(){n.user={},n.login=i,o.showSpinner=!1,n.lang=o.langs.login,e.$watch("$root.langs",function(){n.lang=o.langs.login})}()}t.controller("loginCtrl",a),a.$inject=["$scope","$http","$state","authenticationService","$rootScope"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r){function o(){0==s.client_type&&i(),1==s.client_type&&n()}function i(){r.showSpinner=!0,a.register(s.user).then(function(e){e.data.errors?(r.showSpinner=!1,e.data.errors.existingEmail?(s.existingEmail=e.data.errors.existingEmail,s.registerForm.email.$invalid=!0,s.registerForm.$invalid=!0):(s.existingEmail=!1,s.registerForm.email.$invalid=!1,s.registerForm.email.$valid=!0),e.data.errors.passwordError?(s.passwordError=e.data.errors.passwordError,s.registerForm.password.$invalid=!0,s.registerForm.password2.$invalid=!0,s.registerForm.$invalid=!0):(s.passwordError=!1,s.registerForm.password.$invalid=!1,s.registerForm.password.$valid=!0,s.registerForm.password2.$invalid=!1,s.registerForm.password2.$valid=!0),e.data.errors.telError?(s.telError=e.data.errors.telError,s.registerForm.tel.$invalid=!0,s.registerForm.cel.$invalid=!0,s.registerForm.$invalid=!0):(s.telError=!1,s.registerForm.tel.$invalid=!1,s.registerForm.tel.$valid=!0,s.registerForm.cel.$invalid=!1,s.registerForm.cel.$valid=!0)):(s.success=!0,r.showSpinner=!1)})}function n(){r.showSpinner=!0,a.registerCompany(s.company).then(function(e){e.data.errors?(e.data.errors.existingEmail?(s.existingEmail=e.data.errors.existingEmail,s.registerForm.email.$invalid=!0,s.registerForm.$invalid=!0):(s.existingEmail=!1,s.registerForm.email.$invalid=!1,s.registerForm.email.$valid=!0),e.data.errors.passwordError?(s.passwordError=e.data.errors.passwordError,s.registerForm.password.$invalid=!0,s.registerForm.password2.$invalid=!0,s.registerForm.$invalid=!0):(s.passwordError=!1,s.registerForm.password.$invalid=!1,s.registerForm.password.$valid=!0,s.registerForm.password2.$invalid=!1,s.registerForm.password2.$valid=!0),e.data.errors.telError?(s.telError=e.data.errors.telError,s.registerForm.tel.$invalid=!0,s.registerForm.cel.$invalid=!0,s.registerForm.$invalid=!0):(s.telError=!1,s.registerForm.tel.$invalid=!1,s.registerForm.tel.$valid=!0,s.registerForm.cel.$invalid=!1,s.registerForm.cel.$valid=!0)):(s.success=!0,r.showSpinner=!1)})}var s=this;!function(){s.user={},s.company={},s.register=o,s.success=!1,s.client_type=0}()}t.controller("registerCtrl",a),a.$inject=["$http","$state","authenticationService","$rootScope"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o,i,n){function s(){c.collapse=!c.collapse,c.lang.hide_show=c.collapse?c.lang.show_menu:c.lang.hide_menu}function l(e){"small"==e?(c.toggleSmall=!c.toggleSmall,c.toggleSmall&&(c.toggleBusiness=!1)):(c.toggleBusiness=!c.toggleBusiness,c.toggleBusiness&&(c.toggleSmall=!1))}var c=this;!function(){c.toggle=l,c.toggleSmall=!1,c.toggleBusiness=!1,c.lang=o.langs.dashboard,r.$watch("$root.langs",function(){c.lang=o.langs.dashboard,c.lang.hide_show=c.collapse?c.lang.show_menu:c.lang.hide_menu}),c.collapse=!1,c.collapse_sidebar=s,c.isAdmin=JSON.parse(sessionStorage.getItem("isAdmin")),c.clientType=JSON.parse(sessionStorage.getItem("clientType")),"dashboard"==t.current.name&&n.checkAuth().then(function(e){if(0==e.data.client_type&&0==e.data.isAdmin&&0==e.data.showTutorial){var t=e.data.uid;i.open({templateUrl:"./hbr-selfie/dist/routes/dashboard/modals/tutorial.template.html",controller:"modalTutorialCtrl",controllerAs:"tutorial",backdrop:"static",size:"md",resolve:{userId:function(){return t}}})}})}()}function r(e,t,a,r,o,i,n,s,l){function c(){e.step=e.step+1,$(".modal-body").scrollTop(0)}function d(){e.step=e.step-1,$(".modal-body").scrollTop(0)}function u(){if(p.dontShow){var e=l;s.tutorialChange(e).then(function(e){r.dismiss("cancel")})}else r.dismiss("cancel")}var p=this;!function(){p.cancel=u,p.dontShow=!1,e.step=1,p.next=c,p.prev=d}()}t.controller("dashboardCtrl",a),a.$inject=["$http","$state","$filter","$scope","$rootScope","$uibModal","authenticationService"],t.controller("modalTutorialCtrl",r),r.$inject=["$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","usersService","userId"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o){function i(e){return o.trustAsResourceUrl(e)}var n=this;!function(){n.paymentGatewayUrl=a.params.paymentGatewayUrl,n.trustSrc=i}()}t.controller("checkoutCtrl",a),a.$inject=["$http","$filter","$state","$scope","$sce"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a){!function(){e.post("./hbr-selfie/dist/php/validate_success.php",{token:a.token}).then(function(a){a.data.validate?e.post("./hbr-selfie/dist/php/notificacion_venta.php",{email:a.data.email,name:a.data.name+" "+a.data.lastname,lote:a.data.lote,date:a.data.date}):t.go("dashboard.error",{},{reload:!0})})}()}t.controller("successCtrl",a),a.$inject=["$http","$state","$stateParams"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t){}t.controller("errorCtrl",a),a.$inject=["$http","$state"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o,i){function n(e,t){i.open({templateUrl:"edituser.html",controller:"modalEditUserCtrl",controllerAs:"modalEditUser",size:e,resolve:{user:function(){return t}}})}function s(){i.open({templateUrl:"adduser.html",controller:"modalAddUserCtrl",controllerAs:"modalAddUser",size:"md",resolve:{userType:function(){return 0}}})}function l(){i.open({templateUrl:"adduser.html",controller:"modalAddUserCtrl",controllerAs:"modalAddUser",size:"md",resolve:{userType:function(){return 1}}})}function c(e,t){i.open({templateUrl:"deleteuser.html",controller:"modalDeleteUserCtrl",controllerAs:"modalDeleteUser",size:e,resolve:{user:function(){return t}}})}function d(e){n("md",e)}function u(e){c("md",e)}function p(t){console.log(t),e.changeRoles(t).then(function(e){e.data.errors||o.go("dashboard.users",{},{reload:!0})})}var h=this;!function(){h.client_type=o.params.client_type,r.get("./hbr-selfie/dist/php/users.php",{params:{client_type:h.client_type,action:"getAll"}}).then(function(e){h.userlist=e.data.users,t.totalItems=h.userlist.length,t.currentPage=1,t.itemsPerPage=5,t.maxSize=5,t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){},t.$watch("search",function(e){var r=e;t.filtered=a("filter")(h.userlist,r),t.currentPage=1})}),h.editUser=d,h.addUser=s,h.addCompany=l,h.removeUser=u,h.changePrivileges=p}()}function r(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.adduser(h.user).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.users",{},{reload:!0}))})}function p(){e.addcompany(h.user).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.business",{},{reload:!0}))})}var h=this;!function(){t.values=[{id:1,name:"Cuit"},{id:2,name:"Cuil"}],t.title="Add User",t.showCompanyForm=!1,"1"==s&&(t.title="Add Company",t.showCompanyForm=!0),h.user={},h.cancel=d,h.adduser=u,h.addcompany=p}()}function o(t,a,r,o,i,n,s,l,c,d){function u(){i.dismiss("cancel")}function p(){t.editusers(h.user).then(function(e){e.data.errors||(i.dismiss("cancel"),a.showCompanyForm?r.go("dashboard.business",{},{reload:!0}):r.go("dashboard.users",{},{reload:!0}))})}var h=this;!function(){a.values=[{id:1,name:"Cuit"},{id:2,name:"Cuil"}],a.title="Edit User",c.company_name&&c.company_name.length>0&&(a.title="Edit Company",a.showCompanyForm=!0),h.user=c,h.user.oldEmail=e.copy(h.user.email),h.cancel=u,h.edit=p}()}function i(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.deleteusers(p.user).then(function(e){e.data.errors||(o.dismiss("cancel"),t.showCompanyForm?a.go("dashboard.business",{},{reload:!0}):a.go("dashboard.users",{},{reload:!0}))})}var p=this;!function(){p.user=l,p.cancel=d,p.deleteUser=u}()}t.controller("usersCtrl",a),a.$inject=["usersService","$scope","$filter","$http","$state","$uibModal"],t.controller("modalAddUserCtrl",r),r.$inject=["usersService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","userType","$rootScope","$http"],t.controller("modalEditUserCtrl",o),o.$inject=["usersService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","user","$http"],t.controller("modalDeleteUserCtrl",i),i.$inject=["usersService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","user","$http"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o){function i(e){o.open({templateUrl:"./hbr-selfie/dist/routes/warehouse/modals/addwarehouse.template.html",controller:"modalAddWarehouseCtrl",controllerAs:"modalAddWarehouse",size:e,resolve:{warehouses:function(){return u.warehouses}}})}function n(e,t){o.open({templateUrl:"./hbr-selfie/dist/routes/warehouse/modals/editwarehouse.template.html",controller:"modalEditWarehouseCtrl",controllerAs:"modalEditWarehouse",size:e,resolve:{warehouse:function(){return t}}})}function s(e,t){o.open({templateUrl:"./hbr-selfie/dist/routes/warehouse/modals/deletewarehouse.template.html",controller:"modalDeleteWarehouseCtrl",controllerAs:"modalDeleteWarehouse",size:e,resolve:{warehouse:function(){return t}}})}function l(){i("md")}function c(e){n("md",e)}function d(e){s("md",e)}var u=this;!function(){e.get("./hbr-selfie/dist/php/warehouse.php",{params:{action:"getAll"}}).then(function(e){u.warehouses=e.data.warehouses,t.totalItems=u.warehouses.length,t.currentPage=1,t.itemsPerPage=5,t.maxSize=5,t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){},t.$watch("search",function(e){var r=e;t.filtered=a("filter")(u.warehouses,r),t.currentPage=1})}),u.newWarehouse=l,u.editWarehouse=c,u.removeWarehouse=d}()}function r(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.add_warehouse(p.warehouse).then(function(e){e.data.errors?(e.data.errors.existingEmail?(p.existingEmail=e.data.errors.existingEmail,p.registerForm.email.$invalid=!0,p.registerForm.$invalid=!0):(p.existingEmail=!1,p.registerForm.email.$invalid=!1,p.registerForm.email.$valid=!0),e.data.errors.passwordError?(p.passwordError=e.data.errors.passwordError,p.registerForm.password.$invalid=!0,p.registerForm.password2.$invalid=!0,p.registerForm.$invalid=!0):(p.passwordError=!1,p.registerForm.password.$invalid=!1,p.registerForm.password.$valid=!0,p.registerForm.password2.$invalid=!1,p.registerForm.password2.$valid=!0),e.data.errors.telError?(p.telError=e.data.errors.telError,p.registerForm.tel.$invalid=!0,p.registerForm.cel.$invalid=!0,p.registerForm.$invalid=!0):(p.telError=!1,p.registerForm.tel.$invalid=!1,p.registerForm.tel.$valid=!0,p.registerForm.cel.$invalid=!1,p.registerForm.cel.$valid=!0)):(o.dismiss("cancel"),a.go("dashboard.warehouse",{},{reload:!0}))})}var p=this;!function(){p.warehouse={},p.warehouses=l,p.cancel=d,p.addWarehouse=u}()}function o(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.editWarehouse(p.warehouse).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.warehouse",{},{reload:!0}))})}var p=this;!function(){p.warehouse=l,p.previousEmail=l.email,p.cancel=d,p.editWarehouse=u}()}function i(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.deleteWarehouse(p.warehouse).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.warehouse",{},{reload:!0}))})}var p=this;!function(){p.warehouse=l,p.cancel=d,p.deleteWarehouse=u}()}t.controller("warehouseCtrl",a),a.$inject=["$http","$scope","$filter","$state","$uibModal","warehouseService"],t.controller("modalAddWarehouseCtrl",r),r.$inject=["warehouseService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","warehouses","$http"],t.controller("modalEditWarehouseCtrl",o),o.$inject=["warehouseService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","warehouse","$http","warehouseService"],t.controller("modalDeleteWarehouseCtrl",i),i.$inject=["warehouseService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","warehouse","$http","warehouseService"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s){function l(e,t,a){i.open({templateUrl:"processPayment.html",backdrop:"static",keyboard:!1,controller:"modaProcessCtrl",controllerAs:"modaProcess",size:e,resolve:{venta:function(){return t},bills:function(){return a}}})}function c(e){h.confirmModal=i.open({templateUrl:"finish-lot.html",backdrop:"static",keyboard:!1,scope:o,size:"sm"}),o.tempFinishLot=e,o.confirmFinishLot=function(){n.showSpinner=!0,e.reason=o.tempFinishLot.reason,t.post("./hbr-selfie/dist/php/shopping.php",{peso_excedente:e.peso_excedente,id:e.id||null,parcial_price:e.total,total_weight:e.total_weight,total:e.total,total_quantity:e.total_quantity,userId:e.uid,venta_state:1,status:"Finalizado por Admin.",reason:e.reason,method:"POST"}).then(function(e){n.showSpinner=!1,r.go(r.current,{},{reload:!0})})},o.confirmCancelFinishLot=function(){h.confirmModal.dismiss("cancel"),r.go(r.current,{},{reload:!0})}}function d(e,t,a){i.open({templateUrl:"makeGuides.html",backdrop:"static",keyboard:!1,controller:"makeGuidesModalCtrl",controllerAs:"guides",size:e,resolve:{venta:function(){return t},bills:function(){return a}}})}function u(e,t){l("md",e,t)}function p(e,t){d("md",e,t)}var h=this;!function(){n.showSpinner=!0,h.finishLot=c,h.ventas=[],s.checkAuth().then(function(r){1==r.data.isAdmin?(o.filtered=[],t.get("./hbr-selfie/dist/php/get_batch.php",{params:{action:"getAll"}}).then(function(t){t.data.ventas&&e.forEach(t.data.ventas,function(e,a){var r=moment(parseInt(e.timestamp));switch(t.data.ventas[a].dtOrder=e.timestamp,t.data.ventas[a].timestamp=moment(parseInt(e.timestamp)).format("DD/MM/YYYY HH:mm"),t.data.ventas[a].daysSinceRequest=moment().diff(r,"days"),t.data.ventas[a].parcial_price=parseFloat(e.parcial_price).toFixed(2),t.data.ventas[a].total=parseFloat(e.total).toFixed(2),t.data.ventas[a].peso_total=parseFloat(e.peso_total).toFixed(2),t.data.ventas[a].totalWarehouse="0",t.data.ventas[a].totalFlete="0",t.data.ventas[a].totalImpuestos="0",e.status){case"Finalizado":t.data.ventas[a].status="Finished";break;case"En Curso":t.data.ventas[a].status="In Progress";break;case"Finalizado por Admin.":t.data.ventas[a].status="Finished by Admin."}n.showSpinner=!1}),n.showSpinner=!1,h.ventas=t.data.ventas,o.totalItems=Object.keys(h.ventas).length,o.currentPage=1,o.itemsPerPage=5,o.maxSize=5,o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){},o.$watch("search",function(e){var t=e;o.filtered=a("filter")(h.ventas,t),o.currentPage=1}),h.processPayment=u,h.setGuides=p})):r.data.client_type&&(o.filtered=[],t.get("./hbr-selfie/dist/php/get_batch.php",{params:{action:"getByWhId",whId:r.data.uid}}).then(function(t){e.forEach(t.data.ventas,function(e,a){var r=moment(parseInt(e.timestamp));switch(t.data.ventas[a].timestamp=moment(parseInt(e.timestamp)).format("DD/MM/YYYY HH:mm"),t.data.ventas[a].daysSinceRequest=moment().diff(r,"days"),t.data.ventas[a].parcial_price=parseFloat(e.parcial_price).toFixed(2),t.data.ventas[a].total=parseFloat(e.total).toFixed(2),t.data.ventas[a].peso_total=parseFloat(e.peso_total).toFixed(2),t.data.ventas[a].totalWarehouse="0",t.data.ventas[a].totalFlete="0",t.data.ventas[a].totalImpuestos="0",e.status){case"Finalizado":t.data.ventas[a].status="Finished";break;case"En Curso":t.data.ventas[a].status="In Progress";break;case"Finalizado por Admin.":t.data.ventas[a].status="Finished by Admin."}n.showSpinner=!1}),e.forEach(t.data.ventas,function(e){e.bills.length&&h.ventas.push(e)}),o.totalItems=Object.keys(h.ventas).length,o.currentPage=1,o.itemsPerPage=5,o.maxSize=5,o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){},o.$watch("search",function(e){var t=e;o.filtered=a("filter")(h.ventas,t),o.currentPage=1}),h.processPayment=u,h.setGuides=p}))})}()}function r(t,a,r,o,i,n,s,l,c,d,u){function p(){o.dismiss("cancel"),a.go(a.current,{},{reload:!0})}function h(){u.post("./hbr-selfie/dist/php/encrypt.php",{timestamp:Math.round((new Date).getTime()/1e3)}).then(function(e){$.successUrl="https://tucourier.com.ar/hbr-selfie/dashboard/shopping/checkout/success/"+e.data,$.token=e.data})}function f(){u.put("./hbr-selfie/dist/php/shopping.php",{paymentGatewayUrl:$.paymentGatewayUrl,id:$.venta.id,token:$.token}).then(function(e){u.post("./hbr-selfie/dist/php/cargar_venta.php",{lote:$.venta.id,name:$.user.name+" "+$.user.lastname,email:$.user.email}).then(function(e){a.reload(),o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})})}function g(e){$.currentProduct={},$.currentProduct.id=e.id,$.currentProduct.category=e.category_name,$.currentProduct.product_name=e.product_name,$.currentProduct.price=parseFloat(e.price/e.quantity).toFixed(2),$.currentProduct.flete=parseFloat(Math.ceil(e.weight/e.quantity*2)/2*2.8).toFixed(2),$.currentProduct.seguro=parseFloat(10).toFixed(2),$.currentProduct.derecho=parseFloat(0).toFixed(2),$.currentProduct.derecho_percent=parseFloat(0).toFixed(2),$.currentProduct.estadistica=parseFloat(0).toFixed(2),$.currentProduct.estadistica_percent=parseFloat(.5).toFixed(2),$.currentProduct.base_iva=parseFloat(0).toFixed(2),$.currentProduct.documentacion=parseFloat(0).toFixed(2),$.currentProduct.iva_percent=parseFloat(21).toFixed(2),$.currentProduct.iva_adic_percent=parseFloat(0).toFixed(2),$.currentProduct.iva_adic=parseFloat(0).toFixed(2),$.currentProduct.total_iva=parseFloat(0).toFixed(2),m(),$.showProductInfo=!0}function m(){$.currentProduct.price=parseFloat($.currentProduct.price).toFixed(2),$.currentProduct.flete=parseFloat($.currentProduct.flete).toFixed(2),$.currentProduct.seguro=parseFloat($.currentProduct.seguro).toFixed(2),$.currentProduct.cif=parseFloat($.currentProduct.cif).toFixed(2),$.currentProduct.cif=(parseFloat($.currentProduct.price)+parseFloat($.currentProduct.flete)+parseFloat($.currentProduct.seguro)).toFixed(2),b(),_()}function b(){$.currentProduct.derecho_percent=parseFloat($.currentProduct.derecho_percent).toFixed(2),$.currentProduct.estadistica_percent=parseFloat($.currentProduct.estadistica_percent).toFixed(2),$.currentProduct.derecho_percent>0&&($.currentProduct.derecho=(parseFloat($.currentProduct.cif)*parseFloat($.currentProduct.derecho_percent)/100).toFixed(2)),$.currentProduct.estadistica_percent>0&&($.currentProduct.estadistica=(parseFloat($.currentProduct.cif)*parseFloat($.currentProduct.estadistica_percent)/100).toFixed(2)),$.currentProduct.derecho&&$.currentProduct.estadistica&&($.currentProduct.total_derechos=(parseFloat($.currentProduct.derecho)+parseFloat($.currentProduct.estadistica)).toFixed(2),_())}function _(){$.currentProduct.base_iva=parseFloat($.currentProduct.base_iva).toFixed(2),$.currentProduct.iva=parseFloat($.currentProduct.iva).toFixed(2),$.currentProduct.iva_percent=parseFloat($.currentProduct.iva_percent).toFixed(2),$.currentProduct.base_iva=(parseFloat($.currentProduct.cif)+parseFloat($.currentProduct.total_derechos)+parseFloat($.currentProduct.documentacion)).toFixed(2),$.currentProduct.base_iva>0&&$.currentProduct.iva_percent>0&&($.currentProduct.iva=parseFloat(parseFloat($.currentProduct.iva_percent)*parseFloat($.currentProduct.base_iva)/100).toFixed(2)),$.currentProduct.base_iva>0&&$.currentProduct.iva_adic_percent>0&&($.currentProduct.iva_adic=parseFloat(parseFloat($.currentProduct.iva_adic_percent)*parseFloat($.currentProduct.base_iva)/100).toFixed(2)),$.currentProduct.total_iva=(parseFloat($.currentProduct.iva)+parseFloat($.currentProduct.iva_adic)).toFixed(2),$.currentProduct.total=(parseFloat($.currentProduct.base_iva)+parseFloat($.currentProduct.total_iva)).toFixed(2),e.forEach($.products,function(e,t){e.id==$.currentProduct.id&&($.products[t].total_taxes=$.currentProduct.total)})}function w(){$.totalWarehouse=(parseFloat($.batch.wh_entry)+parseFloat($.batch.adic_kg)+parseFloat($.batch.adic_charges)).toFixed(2),x($.totalWarehouse,$.totalFlete)}function v(){$.totalFlete=(parseFloat($.batch.flete_internacional)*parseFloat($.venta.peso_total)).toFixed(2),x($.totalWarehouse,$.totalFlete)}function x(e,t){$.totalButton=(parseFloat(e)+parseFloat(t)).toFixed(2)}function y(){e.forEach($.products,function(e){g(e)}),$.showProductInfo=!1,e.forEach($.products,function(e){$.totalBatchTaxes=(parseFloat(e.total_taxes)+parseFloat($.totalBatchTaxes)).toFixed(2)})}var $=this;!function(){$.venta=c,$.bills=d,$.batch={},$.venta.peso_total=parseFloat($.venta.peso_total).toFixed(2),$.venta.parcial_price=parseFloat($.venta.parcial_price).toFixed(2),u.get("./hbr-selfie/dist/php/users.php",{params:{action:"getUserById",id:$.venta.uid}}).then(function(e){$.user=e.data}),$.totalTax=[],$.cancel=p,$.collapsedWarehouse=!0,$.collapsedFlete=!0,$.send=f,$.totalBatchTaxes=parseFloat(0).toFixed(2),$.showProductInfo=!1,$.generateToken=h,$.processProduct=g,$.calcProduct=m,$.calcRights=b,$.calcBaseIva=_,$.totalWarehouse=parseFloat(0).toFixed(2),$.totalFlete=parseFloat(0).toFixed(2),$.totalButton=parseFloat(0).toFixed(2),$.batch.wh_entry=parseFloat(0).toFixed(2),$.batch.adic_kg=parseFloat(0).toFixed(2),$.batch.adic_charges=parseFloat(0).toFixed(2),$.batch.guide_amount=parseInt(0),$.batch.flete_internacional=parseFloat(0).toFixed(2),$.calcWarehouse=w,$.calcFlete=v,$.calcButton=x,y()}()}function o(t,a,r,o,i,n,s,l,c,d,u,p,h){function f(){o.dismiss("cancel"),a.go(a.current,{},{reload:!0})}function g(t){e.forEach(C.bills,function(e){t.bill_id!==e.bill_id&&(e.isOpen=!1)}),t.isOpen=!t.isOpen,C.selectedBill=t.isOpen?t:{}}function m(){C.guideBatch.length?(C.guideNumber=parseInt(C.guideBatch.length)+1,C.guideBatch.push({number:C.guideNumber,products:[],quantity:"",weight:"",price:""})):(C.guideNumber++,C.guideBatch.push({number:C.guideNumber,products:[],quantity:"",weight:"",price:""}))}function b(t,a,o,i){C.venta.total_remaining_quantity=parseInt(parseInt(C.venta.total_remaining_quantity)-parseInt(i));var n=0;e.forEach(C.guideBatch,function(s){e.forEach(a.products,function(l){if(l.product_id==t.product_id&&l.quantity>0&&s.number===o){var c=e.copy(l);if(c.exist=void 0!==r("filter")(s.products,{product_id:c.product_id})[0],c.exist){var d=r("filter")(s.products,{product_id:c.product_id})[0];d.quantity=parseInt(parseInt(d.quantity)+parseInt(i)),l.remaining_quantity=parseInt(l.remaining_quantity)-parseInt(i),a.remaining_quantity=parseInt(a.remaining_quantity)-parseInt(i)}else c.quantity=parseInt(i),s.products.push(c),l.remaining_quantity=parseInt(l.remaining_quantity)-parseInt(i),a.remaining_quantity=parseInt(a.remaining_quantity)-parseInt(i);s.quantity=parseInt(s.quantity||0)+parseInt(i||0),s.weight=parseFloat(parseFloat(s.weight||0)+parseFloat(parseFloat(t.real_weight||t.weight||0)*i)).toFixed(2),s.price=parseFloat(parseFloat(s.price||0)+parseFloat(parseFloat(t.price||0)*i)).toFixed(2),s.ventaId=C.venta.id,s.whId=a.whId,s.weight>40||s.price>900?($("#guide_list_"+s.number).addClass("row-warning"),C.danger_msg="",(s.weight>=50||s.price>=1e3)&&($("#guide_list_"+s.number).removeClass("row-warning"),$("#guide_list_"+s.number).addClass("row-danger"),n=++n)):($("#guide_list_"+s.number).removeClass("row-warning"),$("#guide_list_"+s.number).removeClass("row-danger"))}})}),C.danger_msg=n>0?"Has Excedido el limite de 50 Kg o U$D 1,000.00":"",0==a.products.length?C.hideTable=!0:C.hideTable=!1,C.selectedGuide=null,C.selectedQuantity=null}function _(t,a){e.forEach(C.bills,function(a){e.forEach(a.products,function(e){e.product_id==t.product_id&&(e.remaining_quantity=parseInt(parseInt(e.remaining_quantity)+parseInt(t.quantity)),a.remaining_quantity=parseInt(parseInt(a.remaining_quantity)+parseInt(t.quantity)),C.venta.total_remaining_quantity=parseInt(parseInt(C.venta.total_remaining_quantity)+parseInt(t.quantity)),C.venta.guide_amount=C.guideBatch.length,p.updateProduct(e),p.updateBill(a),p.updateVenta(C.venta))})}),e.forEach(a.products,function(e,r){e.product_id==t.product_id&&(a.products.splice(r,1),a.quantity=parseInt(parseInt(a.quantity)-parseInt(t.quantity)),a.weight=parseFloat(parseFloat(a.weight)-parseFloat(t.real_weight)*t.quantity).toFixed(2),a.price=parseFloat(parseFloat(a.price)-parseFloat(t.price)*t.quantity).toFixed(2),C.deleted||u.post("./hbr-selfie/dist/php/delete_product_guide.php",{id:t.awb_productId}).then(function(){p.save(a)}))});var r=0;a.weight>40||a.price>900?($("#guide_list_"+a.number).addClass("row-warning"),C.danger_msg="",(a.weight>50||50==a.weight||a.price>1e3||1e3==a.price)&&0==a.state&&($("#guide_list_"+a.number).removeClass("row-warning"),$("#guide_list_"+a.number).addClass("row-danger"),r=++r)):($("#guide_list_"+a.number).removeClass("row-warning"),$("#guide_list_"+a.number).removeClass("row-danger")),C.danger_msg=r>0?"Has Excedido el limite de 50 Kg o U$D 1,000.00":""}function w(a,r){a.remaining_quantity>0&&(C.activeEditing=!C.activeEditing,t.realWeight=e.copy(a.real_weight||a.weight||0),t.RealWeightProduct=a)}function v(a){C.activeEditing=!1;var o="",i="",n=0;e.forEach(C.bills,function(s){s.total_weight=0,o=r("filter")(s.products,{product_id:t.RealWeightProduct.product_id})[0],void 0!==o&&(o.real_weight=a,o.total_weight=parseFloat(parseFloat(o.real_weight)*parseInt(o.quantity)),e.forEach(C.guideBatch,function(e){(i=r("filter")(e.products,{product_id:o.product_id})[0])&&(i.real_weight=parseFloat(o.real_weight).toFixed(2),i.total_weight=parseFloat(parseFloat(i.real_weight)*parseInt(i.quantity)),p.addProductToAwb(i))})),e.forEach(s.products,function(e){s.total_weight=parseFloat(parseFloat(s.total_weight)+parseFloat(e.total_weight))}),p.updateBill(s),n=parseFloat(parseFloat(n)+parseFloat(s.total_weight))}),o&&p.updateProduct(o),C.venta.total_weight=n,p.updateVenta(C.venta)}function x(t,a){var r=0,o=h.defer();o.resolve(),o=o.promise,C.guideBatch.splice(a,1),e.forEach(t.products,function(e){o=o.then(function(){u.post("./hbr-selfie/dist/php/delete_product_guide.php",{id:e.awb_productId}).then(function(){C.deleted=!0,_(e,t)})})}),u.post("./hbr-selfie/dist/php/delete_guide.php",{id:t.airwayId}).then(function(){var t=h.defer();t.resolve(),t=t.promise;var a=0;e.forEach(C.guideBatch,function(e){e.number=++r,t=t.then(function(){return p.updateGuide(e)}).then(function(){e.weight>40||e.price>900?($("#guide_list_"+e.number).addClass("row-warning"),C.danger_msg="",(e.weight>=50||e.price>=1e3)&&($("#guide_list_"+e.number).removeClass("row-warning"),$("#guide_list_"+e.number).addClass("row-danger"),a=++a)):($("#guide_list_"+e.number).removeClass("row-warning"),$("#guide_list_"+e.number).removeClass("row-danger"))})})}),C.danger_msg=ExceedAmount>0?"Has Excedido el limite de 50 Kg o U$D 1,000.00":""}function y(t,a){var r=e.copy(C.venta.bills[a]);return r.wh_enter_date=new Date(t).getTime()/1e3||null,r.set_wh_date=!0,C.venta.bills[a].spinner=!0,p.updateBill(r).then(function(e){u.post("./hbr-selfie/dist/php/notifications/wh_notifications.php",{ventaId:C.venta.id,bill_number:r.number,wh_enter_date:r.wh_enter_date,email:r.warehouse[0].email,name:r.warehouse[0].name,user:C.venta.user[0].name+" "+C.venta.user[0].lastname,action:"whEnterDate"}).then(function(e){u.post("./hbr-selfie/dist/php/notifications/wh_notifications_user.php",{ventaId:C.venta.id,bill_number:r.number,wh_enter_date:r.wh_enter_date,name:r.warehouse[0].name,email:C.venta.user[0].email,action:"whEnterDate"}).then(function(){C.venta.bills[a].spinner=!1,C.venta.bills[a].changed=!1,C.venta.bills[a].saved=!0})})})}function F(){0===C.venta.remaining_quantity&&(C.guideBatch.finished=!0);var t=h.defer();t.resolve(),t=t.promise,e.forEach(C.guideBatch,function(a){a.products.length>0&&(t=t.then(function(){return p.save(a).then(function(t){e.forEach(a.products,function(e){e.airwayId=t.data.airwayId,p.addProductToAwb(e)})})}))}),I(),a.go("dashboard.process_payments",{reload:!0})}function I(){var t=h.defer();t.resolve(),t=t.promise;var r=0;e.forEach(C.venta.bills,function(a){var o=0;e.forEach(a.products,function(e){o=parseInt(parseInt(o)+parseInt(e.remaining_quantity))}),a.remaining_quantity=o,t=t.then(function(){return a.wh_enter_date=new Date(a.wh_enter_date).getTime()/1e3||null,p.updateBill(a).then(function(t){e.forEach(a.products,function(e){p.updateProduct(e)})})}),r=parseInt(parseInt(r)+parseInt(a.remaining_quantity))}),C.venta.total_remaining_quantity=r,C.venta.guide_amount=C.guideBatch.length,p.updateVenta(C.venta).then(function(e){o.dismiss("cancel"),a.go("dashboard.process_payments",{reload:!0})})}function B(e,t){C.tempFinishGuide=e,C.tempFinishGuideIndex=t,S()}function S(){C.confirmModal=i.open({templateUrl:"confirm-modal.html",backdrop:"static",keyboard:!1,scope:t,size:"sm"}),t.tempFinishGuide=C.tempFinishGuide}var C=this;t.confirmAccept=function(){C.tempFinishGuide.state=1,p.updateGuide(C.tempFinishGuide),C.confirmModal.dismiss("cancel"),a.go(a.current,{},{reload:!0})},t.confirmCancel=function(){C.confirmModal.dismiss("cancel"),a.go(a.current,{},{reload:!0})},function(){u.post("./hbr-selfie/dist/php/update_batch_status.php",{id:c.id,readed:"1"}),C.updateWhDate=y,C.cancel=f,C.venta=c,C.guideNumber=0,C.bills=d,C.confirmModal=null,e.forEach(C.bills,function(e){e.isOpen=!1,e.wh_enter_date=new Date(1e3*parseInt(e.wh_enter_date))}),C.deleted=!1,C.new_guide=m,C.addToGuide=b,C.removeProduct=_,C.guideBatch=[],C.hideTable=!1,C.activeEditing=!1,C.selectedBill={},C.selectBill=g,C.setRealWeight=w,C.saveRealWeight=v,C.save=F,C.venta.total_remaining_quantity=e.copy(C.venta.total_remaining_quantity),C.deleteGuide=x,C.danger_msg="",C.finishGuide=B,C.tempFinishGuide={},C.tempFinishGuideIndex=0,p.get_airwayBills(C.venta.id,null).then(function(t){C.guideBatch=t.data.guideBatch;var a=0;e.forEach(C.guideBatch,function(e){e.weight>40||e.price>900?($("#guide_list_"+e.number).addClass("row-warning"),C.danger_msg="",(e.weight>50||50==e.weight||e.price>1e3||1e3==e.price)&&0==e.state&&($("#guide_list_"+e.number).removeClass("row-warning"),$("#guide_list_"+e.number).addClass("row-danger"),a=++a)):($("#guide_list_"+e.number).removeClass("row-warning"),$("#guide_list_"+e.number).removeClass("row-danger"))}),C.danger_msg=a>0?"Has Excedido el limite de 50 Kg o U$D 1,000.00":""}).error(function(e){console.log(e)})}()}t.controller("processPaymentsCtrl",a),a.$inject=["$http","$filter","$state","$scope","$uibModal","$rootScope","authenticationService"],t.controller("modaProcessCtrl",r),r.$inject=["$scope","$state","$filter","$uibModalInstance","$uibModal","$sce","$compile","$rootScope","venta","bills","$http"],t.controller("makeGuidesModalCtrl",o),o.$inject=["$scope","$state","$filter","$uibModalInstance","$uibModal","$sce","$compile","$rootScope","venta","bills","$http","airwayService","$q"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s,l,c,d,u){function p(){n.get("./hbr-selfie/dist/php/users.php",{params:{sskey:sessionStorage.getItem("sskey"),action:"getUserBySskey"}}).then(function(e){q.lote.user=e.data})}function h(){var t=[],a=q.lote.timestamp||(new Date).getTime();if(q.spinner=!0,q.lote.total_price=0,q.lote.parcial_price=0,q.lote.total_weight=0,q.lote.total_quantity=0,q.lote.venta_state=1,q.lote.status="Finalizado",e.forEach(q.lote.bills,function(t,a){q.lote.total_price=parseFloat(q.lote.total_price)+parseFloat(t.total_price),q.lote.parcial_price=parseFloat(q.lote.parcial_price)+parseFloat(t.total_price),q.lote.total_weight=parseFloat(q.lote.total_weight)+parseFloat(t.total_weight),q.lote.total_quantity=parseInt(q.lote.total_quantity)+parseInt(t.quantity),e.forEach(t.products,function(e,t){e.categoryId=parseInt(e.category.category_id)})}),q.lote.total_quantity>0&&q.lote.total_spent_quantity)var r=parseInt(q.lote.total_quantity)-q.lote.total_spent_quantity;else var r=q.lote.total_quantity;n.post("./hbr-selfie/dist/php/shopping.php",{peso_excedente:q.lote.peso_excedente,id:q.lote.id||null,parcial_price:q.lote.total_price,total_weight:q.lote.total_weight,total:q.lote.total_price,total_quantity:q.lote.total_quantity,userId:q.lote.user.id,timestamp:a,venta_state:q.lote.venta_state,status:q.lote.status,total_remaining_quantity:r,method:"POST"}).then(function(a){if(a.data.success){q.response=a;var r=u.defer();r.resolve(),r=r.promise,e.forEach(q.lote.bills,function(o){-1==t.indexOf(o.warehouse.email)&&t.push(o.warehouse.email),r=r.then(function(){return l.uploadBills(o,a.ventaId,q.lote.user.id,(new Date).getTime()).then(function(t){e.forEach(o.products,function(e){e.bill_id=t.bill_id,e.userId=q.lote.user.id,l.uploadProducts(e)})})})}),u.all(r).then(function(){n.post("./hbr-selfie/dist/php/solicitud_venta.php",{lote:q.response.lote,date:q.response.date,email:q.response.email,name:q.response.name+" "+q.response.lastname,whEmail:t}).then(function(e){setTimeout(function(){s.go("dashboard.shopping_list",{},{reload:!0}),q.spinner=!1},2e3)})})}})}function f(){var t=[],a=q.lote.timestamp||(new Date).getTime();if(q.spinner=!0,q.lote.total_price=0,q.lote.parcial_price=0,q.lote.total_weight=0,q.lote.total_quantity=0,q.lote.venta_state=0,q.lote.status="En Curso",e.forEach(q.lote.bills,function(t,a){t.bill_state=1,q.lote.total_price=parseFloat(q.lote.total_price)+parseFloat(t.total_price),q.lote.parcial_price=parseFloat(q.lote.parcial_price)+parseFloat(t.total_price),q.lote.total_weight=parseFloat(q.lote.total_weight)+parseFloat(t.total_weight),q.lote.total_quantity=parseInt(q.lote.total_quantity)+parseInt(t.quantity),e.forEach(t.products,function(e,t){e.categoryId=parseInt(e.category.category_id)})}),q.lote.total_quantity>0&&q.lote.total_spent_quantity)var r=parseInt(q.lote.total_quantity)-q.lote.total_spent_quantity;else var r=q.lote.total_quantity;n.post("./hbr-selfie/dist/php/shopping.php",{peso_excedente:q.lote.peso_excedente,id:q.lote.id||null,parcial_price:q.lote.total_price,total_weight:q.lote.total_weight,total:q.lote.total_price,total_quantity:q.lote.total_quantity,userId:q.lote.user.id,timestamp:a,venta_state:q.lote.venta_state,status:q.lote.status,total_remaining_quantity:r,method:"POST"}).then(function(a){if(a.success){q.response=a;var r=u.defer();r.resolve(),r=r.promise,e.forEach(q.lote.bills,function(o){-1==t.indexOf(o.warehouse.email)&&t.push(o.warehouse.email),r=r.then(function(){return l.uploadBills(o,a.ventaId,q.lote.user.id,(new Date).getTime()).then(function(t){e.forEach(o.products,function(e){e.bill_id=t.bill_id,e.userId=q.lote.user.id,l.uploadProducts(e)})})})}),u.all(r).then(function(){n.post("./hbr-selfie/dist/php/solicitud_venta.php",{lote:q.response.lote,date:q.response.date,email:q.response.email,name:q.response.name+" "+q.response.lastname,whEmail:t}).then(function(e){setTimeout(function(){s.go("dashboard.shopping_list",{},{reload:!0}),q.spinner=!1},2e3)})})}})}function g(e,a){q.confirmModal=o.open({templateUrl:"confirm-modal.html",backdrop:"static",keyboard:!1,scope:t,size:"sm"}),t.title=e,t.msg=a}function m(){g("Continuar Luego","Recuerde que tiene 7 dias para seguir comprando dentro de este lote de compra. A la vez hasta que el lote no este cerrado sus envíos no serán despachados a su domicilio. Ante la necesidad de despachar el lote puede optar por finalizar la compra e iniciar una compra nueva."),t.confirmAccept=function(){q.updateSave(),q.confirmModal.dismiss("cancel")},t.confirmCancel=function(){q.confirmModal.dismiss("cancel")}}function b(){g("Finalizar Compra","Esta seguro que desea finalizar la compra? al finalizar la compra ya no podrá seguir agregando facturas al lote de compras, ni eliminar / editar el mismo."),t.confirmAccept=function(){q.finish(),q.confirmModal.dismiss("cancel")},t.confirmCancel=function(){q.confirmModal.dismiss("cancel")}}function _(){a.get_categories().then(function(t){q.categories=t.category_list,q.lote.bills.length>0&&e.forEach(q.lote.bills,function(t){t.products.length>0&&e.forEach(t.products,function(e){e.category=d("filter")(q.categories,{category_id:e.category_id})[0]})})}).catch(function(e){console.log(e)})}function w(){n.get("./hbr-selfie/dist/php/warehouse.php",{params:{action:"getAll"}}).then(function(e){q.warehouses=e.data.warehouses})}function v(){q.bill.establishment.length&&q.bill.number.length&&q.bill.tracking_number.length&&q.bill.provider.length?(q.bill_error="",q.shoppingForm_purchase.name.$invalid=!1,Object.keys(q.aux_product).length?(q.product_error="",q.aux_product.total_weight=(parseFloat(q.aux_product.weight||0)*parseInt(q.aux_product.quantity)).toFixed(2),q.aux_product.total_price=(parseFloat(q.aux_product.price)*parseInt(q.aux_product.quantity)).toFixed(2),q.bill.products.push(q.aux_product),q.bill.total_price=parseFloat(parseFloat(q.bill.total_price)+parseFloat(q.aux_product.price)*parseInt(q.aux_product.quantity)).toFixed(2)||0,q.bill.total_weight=parseFloat(parseFloat(q.bill.total_weight||0)+parseFloat(q.aux_product.weight||0)*parseInt(q.aux_product.quantity)).toFixed(2)||0,q.bill.quantity=parseInt(parseInt(q.bill.quantity)+parseInt(q.aux_product.quantity))||0,q.aux_product={},q.shoppingForm_purchase.$valid=!0,q.shoppingForm_purchase.$setUntouched(),q.shoppingForm_purchase.$setPristine(),q.shoppingForm_purchase.$submitted=!1,q.bill.total_price=0,q.bill.total_weight=0,q.bill.quantity=0,e.forEach(q.bill.products,function(e){q.bill.total_price=parseFloat(parseFloat(q.bill.total_price)+parseFloat(e.price)*parseInt(e.quantity)).toFixed(2)||0,q.bill.total_weight=parseFloat(parseFloat(q.bill.total_weight||0)+parseFloat(e.weight||0)*parseInt(e.quantity)).toFixed(2)||0,q.bill.quantity=parseInt(parseInt(q.bill.quantity)+parseInt(e.quantity))||0}),$("html, body").animate({scrollTop:$("#bill-detail").offset().top},500)):q.product_error="Debe completar la información de producto para continuar"):(q.bill_error="Debe completar la información de factura para continuar",q.shoppingForm_purchase.$submitted=!0)}function x(t,a){q.bill.products.splice(a,1),q.bill.total_price=0,q.bill.total_weight=0,q.bill.quantity=0,e.forEach(q.bill.products,function(e,t){q.bill.total_price=parseFloat(parseFloat(q.bill.total_price)+parseFloat(e.price)*parseInt(e.quantity)).toFixed(2)||0,q.bill.total_weight=parseFloat(parseFloat(q.bill.total_weight||0)+parseFloat(e.weight||0)*parseInt(e.quantity)).toFixed(2)||0,q.bill.quantity=parseInt(parseInt(q.bill.quantity)+parseInt(e.quantity))||0})}function y(){q.bill.establishment.length&&q.bill.number.length&&q.bill.tracking_number.length&&q.bill.provider.length?(q.bill_error="",q.lote.total_price=parseFloat(parseFloat(q.lote.total_price)+parseFloat(q.bill.total_price)).toFixed(2),q.lote.total_weight=parseFloat(parseFloat(q.lote.total_weight||0)+parseFloat(q.bill.total_weight||0)).toFixed(2),q.lote.total_quantity=parseInt(parseInt(q.lote.total_quantity)+parseInt(q.bill.quantity)),q.bill.warehouse=q.bill.whId,q.bill.whId=q.bill.whId.id,q.bill.bill_state=0,q.lote.bills.push(q.bill),$("#bill_file").val(""),q.bill={products:[],number:"",tracking_number:"",provider:"",establishment:"",bill_file:{},total_price:0,total_weight:0,quantity:0,whId:{}},q.aux_product={},$(".notification").show(),setTimeout(function(){$(".notification").hide()},3500),q.shoppingForm_purchase.$valid=!0,q.shoppingForm_purchase.$submitted=!1,q.shoppingForm_purchase.$setPristine(),q.shoppingForm_purchase.$setUntouched()):(q.bill_error="Debe completar la información de factura para continuar",q.shoppingForm_purchase.$submitted=!0)}function F(){$(".notification").removeClass("notification-in"),$(".notification").addClass("notification-out")}function I(a,r,o){t.editBill=!0,q.aux_product={},q.bill=a,q.bill.whId=a.warehouse[0]||a.warehouse,e.forEach(a.products,function(e,t){e.category=d("filter")(q.categories,{category_id:e.category_id})[0],e.total_weight=parseFloat(e.weight)*parseInt(e.quantity),e.total_price=parseFloat(e.price)*parseInt(e.quantity)}),q.collapse_purchase=!1,setTimeout(function(){$("html, body").animate({scrollTop:$("#product-info").offset().top},100)})}function B(a,r){q.oldProduct={},t.editProduct=!0,a.quantity=parseInt(a.quantity),a.price=parseFloat(a.price),a.weight=parseFloat(a.weight),q.aux_product=a,q.oldProduct=e.copy(a)}function S(){q.collapse_list=!1,setTimeout(function(){$("html, body").animate({scrollTop:$("#billList").offset().top},100)},200)}function C(){q.bill.establishment.length&&q.bill.number.length&&q.bill.tracking_number.length&&q.bill.provider.length?(q.bill_error="",q.shoppingForm_purchase.name.$invalid=!1,Object.keys(q.aux_product).length?(q.product_error="",q.aux_product.total_weight=(parseFloat(q.aux_product.weight||0)*parseInt(q.aux_product.quantity)).toFixed(2),q.aux_product.total_price=(parseFloat(q.aux_product.price)*parseInt(q.aux_product.quantity)).toFixed(2),q.bill.total_price=0,q.bill.total_weight=0,q.bill.quantity=0,e.forEach(q.bill.products,function(e){e.product_id===q.aux_product.product_id&&(e=q.aux_product),q.bill.total_price=parseFloat(parseFloat(q.bill.total_price)+parseFloat(e.price)*parseInt(e.quantity)).toFixed(2)||0,q.bill.total_weight=parseFloat(parseFloat(q.bill.total_weight||0)+parseFloat(e.weight||0)*parseInt(e.quantity)).toFixed(2)||0,q.bill.quantity=parseInt(parseInt(q.bill.quantity)+parseInt(e.quantity))||0}),q.aux_product={},q.shoppingForm_purchase.$valid=!0,q.shoppingForm_purchase.$setUntouched(),q.shoppingForm_purchase.$setPristine(),q.shoppingForm_purchase.$submitted=!1):q.product_error="Debe completar la información de producto para continuar"):(q.bill_error="Debe completar la información de factura para continuar",q.shoppingForm_purchase.$submitted=!0),q.lote.total_price=0,q.lote.total_weight=0,q.lote.total_quantity=0,e.forEach(q.lote.bills,function(e){e.bill_id===q.bill.bill_id&&(e=q.bill),q.lote.total_price=(parseFloat(q.lote.total_price)+parseFloat(e.total_price)).toFixed(2),q.lote.total_quantity=parseInt(q.lote.total_quantity)+parseInt(e.quantity),q.lote.total_weight=(parseFloat(q.lote.total_weight)+parseFloat(e.total_weight)).toFixed(2)}),t.editProduct=!1}function k(t,a){q.lote.bills.splice(a,1),q.lote.total_price=0,q.lote.total_quantity=0,q.lote.total_weight=0,e.forEach(q.lote.bills,function(e){q.lote.total_price=(parseFloat(q.lote.total_price)+parseFloat(e.total_price)).toFixed(2),q.lote.total_quantity=parseInt(q.lote.total_quantity)+parseInt(e.quantity),q.lote.total_weight=(parseFloat(q.lote.total_weight)+parseFloat(e.total_weight)).toFixed(2)})}function A(){q.bill.warehouse=q.bill.whId,q.bill.whId=q.bill.whId.id,l.edit_bill(q.bill).then(function(t){t.data.success&&e.forEach(q.bill.products,function(e){return e.bill_id=q.bill.bill_id,e.userId=q.bill.userId,l.edit_product(e)})}).finally(function(){q.bill={products:[],number:"",tracking_number:"",provider:"",establishment:"",bill_file:{},total_price:0,total_weight:0,quantity:0,whId:{}},t.editBill=!1})}function E(e){var t=parseInt(e)+1;q.tabs[t].disabled=!1,q.tabActive=parseInt(e)+2,$("html, body").animate({scrollTop:0},500)}function P(){q.helpOpened=!q.helpOpened,t.ttext=q.helpOpened?"Cerrar Ayuda":"Ver Ayuda"}var q=this;!function(){q.nextStep=E,q.toggleHelp=P,q.helpOpened=!1,t.ttext="Ver Ayuda",$(".notification").hide(),t.editBill=!1,t.editProduct=!1,_(),w(),q.lote=s.params.venta||{user:{},bills:[],total_weight:0,total_price:0,total_quantity:0},q.lote.bills.length>0&&(q.lote.total_price=0,q.lote.total_weight=0,q.lote.total_quantity=0,e.forEach(q.lote.bills,function(e){q.lote.total_price=(parseFloat(q.lote.total_price)+parseFloat(e.total_price)).toFixed(2),q.lote.total_quantity=parseInt(q.lote.total_quantity)+parseInt(e.quantity),q.lote.total_weight=(parseFloat(q.lote.total_weight)+parseFloat(e.total_weight)).toFixed(2)}),q.lote.total_spent_quantity=parseInt(q.lote.total_quantity)-parseInt(q.lote.total_remaining_quantity)),q.get_warehouses=w,q.get_categories=_,q.collapse_personal=!0,q.collapse_purchase=!0,q.collapse_list=!0,q.add_bill=y,q.add_product=v,q.spinner=!1,q.aux_product={},q.removeProduct=x,q.updateSave=f,q.finish=h,q.oldProduct={},q.bill={products:[],number:"",tracking_number:"",provider:"",establishment:"",bill_file:{},total_price:0,total_weight:0,quantity:0,whId:{}},q.addshoping_response={},p(),q.closeNotification=F,q.showBills=S,q.showEditBill=I,q.showEditProduct=B,q.edit_product=C,q.edit_bill=A,q.delete_bill=k,q.confirmUpdate=m,q.confirmFinish=b,q.tabs=[{title:"Información Personal",content:"hbr-selfie/dist/routes/shopping/forms/personal-form-tmpl.html",helpText:""},{title:"Cargar Factura",content:"hbr-selfie/dist/routes/shopping/forms/product-purchase-form-tmpl.html",helpText:"",disabled:!q.lote.bills.length},{title:"Verificar y Finalizar compra",content:"hbr-selfie/dist/routes/shopping/forms/products-list-tmpl.html",helpText:"",disabled:!q.lote.bills.length}]}()}t.controller("shoppingCtrl",a),a.$inject=["$scope","categoryService","productService","$uibModal","$rootScope","$http","$state","uploadService","$timeout","$filter","$q"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s){function l(e){r.go("dashboard.checkout",{paymentGatewayUrl:e.paymentGatewayUrl,reload:!0})}function c(e){}function d(e,t){n.open({templateUrl:"myModalContent.html",controller:"modalMoreInfoCtrl",controllerAs:"seeMore",size:e,resolve:{items:function(){return t},venta:function(){return h.ventas}}})}function u(e){d("md",e)}function p(e){r.go("dashboard.shopping",{venta:e},{reload:!0})}var h=this;!function(){i.showSpinner=!0,h.ventas=[],o.filtered=[],s.checkAuth().then(function(r){t.get("./hbr-selfie/dist/php/get_batch.php",{params:{action:"getByUserId",id:r.data.uid}}).then(function(t){t.data.ventas.length&&(e.forEach(t.data.ventas,function(e){e.requestDate=moment(parseInt(e.timestamp)).format("DD/MM/YYYY HH:mm")}),h.ventas=t.data.ventas),h.moreInfo=u,h.downloadBill=c,h.pay=l,i.showSpinner=!1,o.totalItems=Object.keys(h.ventas).length,o.currentPage=1,o.itemsPerPage=5,o.maxSize=5,o.setPage=function(e){o.currentPage=e},o.pageChanged=function(){},o.$watch("search",function(e){var t=e;o.filtered=a("filter")(h.ventas,t),o.currentPage=1})})}),h.continuePurchase=p}()}function r(e,t,a,r,o,i,n,s,l,c){function d(){r.dismiss("cancel")}var u=this;!function(){u.bills=s,u.venta=l[0],u.cancel=d,console.log(u.bills)}()}t.controller("shoppingListCtrl",a),a.$inject=["$http","$filter","$state","$scope","$rootScope","$uibModal","authenticationService"],t.controller("modalMoreInfoCtrl",r),r.$inject=["$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","items","venta","$http"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n){function s(){o.showSpinner=!0,n.editusers(c.user).then(function(e){e.data.errors?(o.showSpinner=!1,e.data.errors.existingEmail&&(c.existingEmail=e.data.errors.existingEmail),e.data.errors.passwordError&&(c.passwordError=e.data.errors.passwordError)):(sessionStorage.username=c.user.name+" "+c.user.lastname,r.go("home.login",{},{reload:!0}),o.showSpinner=!1)})}function l(){r.go("dashboard",{},{reload:!0})}var c=this;!function(){o.showSpinner=!0,a.values=[{id:1,name:"Cuit"},{id:2,name:"Cuil"}],i.checkAuth().then(function(r){t.get("./hbr-selfie/dist/php/users.php",{params:{action:"getUserById",id:r.data.uid}}).then(function(t){c.user=t.data,c.user.codeType=parseInt(t.data.codeType),c.user.company_name&&c.user.company_name.length>0&&(a.showCompanyForm=!0),c.user.oldEmail=e.copy(t.data.email)}),o.showSpinner=!1}),c.edit=s,c.cancel=l}()}t.controller("profileCtrl",a),a.$inject=["$http","$scope","$state","$rootScope","authenticationService","usersService"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r,o,i,n){function s(){n.open({templateUrl:"./hbr-selfie/dist/routes/products/modals/addproducts.template.html",controller:"modalAddproductCtrl",controllerAs:"modalAddproduct",size:"md"})}function l(e){n.open({templateUrl:"./hbr-selfie/dist/routes/products/modals/editproducts.template.html",controller:"modalEditproductCtrl",controllerAs:"modalEditproduct",size:"md",resolve:{product:function(){return e}}})}function c(e){n.open({templateUrl:"./hbr-selfie/dist/routes/products/modals/deleteproducts.template.html",controller:"modalDeleteproductCtrl",controllerAs:"modalDeleteproduct",size:"md",resolve:{product:function(){return e}}})}function d(e){n.open({templateUrl:"./hbr-selfie/dist/routes/products/modals/changeprivileges.template.html",controller:"modalChangeprivilegesCtrl",controllerAs:"modalChangeprivileges",size:"md",resolve:{product:function(){return e}}})}var u=this;!function(){t.get_products().then(function(e){u.products=e.data.products}).error(function(e){console.log(e)}),u.newproduct=s,u.editproduct=l,u.removeproduct=c,u.changeprivileges=d}()}function r(e,t,a,r,o,i,n,s,l){function c(){i.dismiss("cancel")}function d(){e.add_product(u.product).then(function(e){e.data.errors||(i.dismiss("cancel"),r.go("dashboard.products",{},{reload:!0}))})}var u=this;!function(){t.get_categories().then(function(e){u.categories=e.data.categories}).error(function(e){console.log(e)}),u.categories={},u.product={},u.cancel=c,u.addproduct=d}()}function o(e,t,a,r,o,i,n,s,l,c,d){function u(){i.dismiss("cancel")}function p(){t.edit_product(h.product).then(function(e){e.data.errors||(i.dismiss("cancel"),r.go("dashboard.products",{},{reload:!0}))})}var h=this;!function(){e.get_categories().then(function(e){h.categories=e.data.categories,c.category_id=o("filter")(h.categories,{category_id:c.category_id})[0]}).error(function(e){console.log(e)}),h.product=c,h.cancel=u,h.editproduct=p}()}function i(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.delete_product(p.product).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.products",{},{reload:!0}))})}var p=this;!function(){p.product=l,p.cancel=d,p.deleteproduct=u}()}function n(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.changeprivileges(p.product).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.products",{},{reload:!0}))})}var p=this;!function(){p.product=l,1==l.isPremium?p.action="quitar premium":p.action="hacer premium",p.cancel=d,p.changeprivileges=u}()}t.controller("productCtrl",a),a.$inject=["usersService","productService","$http","$filter","$state","$scope","$uibModal","productService"],t.controller("modalAddproductCtrl",r),r.$inject=["productService","categoryService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","$http"],t.controller("modalEditproductCtrl",o),o.$inject=["categoryService","productService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","product","$http","productService"],t.controller("modalDeleteproductCtrl",i),i.$inject=["productService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","product","$http","productService"],t.controller("modalChangeprivilegesCtrl",n),n.$inject=["productService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","product","$http","productService"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(e,t,a,r){function o(){r.open({templateUrl:"./hbr-selfie/dist/routes/categories/modals/addcategories.template.html",controller:"modalAddcategoryCtrl",controllerAs:"modalAddcategory",size:"md"})}function i(e){r.open({templateUrl:"./hbr-selfie/dist/routes/categories/modals/editcategories.template.html",controller:"modalEditcategoryCtrl",controllerAs:"modalEditcategory",size:"md",resolve:{category:function(){return e}}})}function n(e){r.open({templateUrl:"./hbr-selfie/dist/routes/categories/modals/deletecategories.template.html",controller:"modalDeletecategoryCtrl",controllerAs:"modalDeletecategory",size:"md",resolve:{category:function(){return e}}})}var s=this;t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){},t.$watch("search",function(e){var r=e;t.filtered=a("filter")(s.category_list,r),t.currentPage=1}),function(){e.get_categories().then(function(e){s.category_list=e.data.category_list,t.totalItems=s.category_list.length,t.currentPage=1,t.itemsPerPage=5,t.maxSize=5}),s.newcategory=o,s.editcategory=i,s.removecategory=n}()}function r(e,t,a,r,o,i,n,s){function l(){o.dismiss("cancel")}function c(){e.add_category(d.category).then(function(e){e.data.errors?d.error_msgs=e.data.errors:(o.dismiss("cancel"),a.go("dashboard.categories",{},{reload:!0}))})}var d=this;!function(){d.category={},d.cancel=l,d.addcategory=c,d.error_msgs=[]}()}function o(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){p.old_name!==p.category.name?e.edit_category(p.category).then(function(e){e.data.errors?p.error_msgs=e.data.errors:(o.dismiss("cancel"),a.go("dashboard.categories",{},{reload:!0}))}):d()}var p=this;!function(){p.category=l,p.old_name=p.category.name,p.cancel=d,p.editcategory=u}()}function i(e,t,a,r,o,i,n,s,l,c){function d(){o.dismiss("cancel")}function u(){e.delete_category(p.category).then(function(e){e.data.errors||(o.dismiss("cancel"),a.go("dashboard.categories",{},{reload:!0}))})}var p=this;!function(){t.filtered=[],p.category=l,p.cancel=d,p.deletecategory=u,t.totalItems=Object.keys(p.category).length,t.currentPage=1,t.itemsPerPage=5,t.maxSize=5,t.setPage=function(e){t.currentPage=e},t.pageChanged=function(){},t.$watch("search",function(e){var a=e;t.filtered=r("filter")(p.category,a),t.currentPage=1})}()}t.controller("categoryCtrl",a),a.$inject=["categoryService","$scope","$filter","$uibModal"],t.controller("modalAddcategoryCtrl",r),r.$inject=["categoryService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","$http"],t.controller("modalEditcategoryCtrl",o),o.$inject=["categoryService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","category","$http"],t.controller("modalDeletecategoryCtrl",i),i.$inject=["categoryService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","$rootScope","category","$http"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s,l,c){function d(e,t,a){s.open({templateUrl:"process-airway.html",backdrop:"static",keyboard:!1,controller:"ProcessModalCtrl",controllerAs:"airwaybill",size:e,resolve:{awb:function(){return t},products:function(){return a}}})}function u(e,t){d("md",e,t)}var p=this;!function(){n.filtered=[],p.guides=[];var t=sessionStorage.getItem("clientType"),a=sessionStorage.getItem("isAdmin");r.get_finished_airwaybills().then(function(r){e.forEach(r.data.guideBatch,function(e){console.log(e),e.username=e.user[0].name+" "+e.user[0].lastname,e.warehousename=e.warehouse[0].name}),p.guideBatch=r.data.guideBatch,0==a&&2==t?(p.isWh=!0,o.getPremium().then(function(t){var a=[];e.forEach(p.guideBatch,function(e){e.warehouse[0].id==t.data.id&&a.push(e)}),p.guides=a||[]}).catch(function(e){console.log(e)})):p.guides=p.guideBatch,n.totalItems=p.guides.length,n.currentPage=1,n.itemsPerPage=5,n.maxSize=5,n.setPage=function(e){n.currentPage=e},n.pageChanged=function(){},n.$watch("search",function(e){var t=e;n.filtered=i("filter")(p.guides,t),n.currentPage=1})}),p.processAirwayBill=u}()}function r(t,a,r,o,i,n,s,l,c,d,u,p,h){function f(){o.dismiss("cancel")}function g(){u.post("./hbr-selfie/dist/php/encrypt.php",{timestamp:Math.round((new Date).getTime()/1e3)}).then(function(e){k.batch.successUrl="https://tucourier.com.ar/hbr-selfie/dashboard/shopping/checkout/success/"+e.data,k.batch.token=e.data})}function m(){k.totalWarehouse=(parseFloat(k.batch.wh_entry)+parseFloat(k.batch.adic_kg)+parseFloat(k.batch.adic_charges)).toFixed(2),_(k.totalWarehouse,k.totalFlete)}function b(){k.totalFlete=(parseFloat(k.batch.flete_internacional)*parseFloat(k.awb.weight)).toFixed(2),_(k.totalWarehouse,k.totalFlete)}function _(e,a){k.totalButton=(parseFloat(e)+parseFloat(a)).toFixed(2),parseFloat(e)>0&&parseFloat(a)>0&&(t.noCalculated=!1)}function w(){e.forEach(k.awb.products,function(e){k.totalBatchTaxes=(parseFloat(e.total_taxes)+parseFloat(k.totalBatchTaxes)).toFixed(2)})}function v(){k.awb.shipment_international=k.batch.flete_internacional||null,k.awb.shipment_total=k.totalFlete||null,k.awb.state=1,t.shipmentSave="",p.updateGuide(k.awb).then(function(e){t.shipmentSave="Saved"})}function x(){k.awb.warehouse_enter=k.batch.wh_entry||null,k.awb.warehouse_aditional_weight=k.batch.adic_kg||null,k.awb.warehouse_aditional_charges=k.batch.adic_charges||null,k.awb.warehouse_total=k.totalWarehouse||null,k.awb.state=1,t.warehouseSave="",p.updateGuide(k.awb).then(function(e){t.warehouseSave="Saved"})}function y(){l.showSpinner=!0,k.awb.arrivalDate=new Date(k.batch.arrivalDate).getTime()/1e3,k.awb.leaveDate=new Date(k.batch.leaveDate).getTime()/1e3,k.awb.estimatedArrivalDate=new Date(k.batch.estimatedArrivalDate).getTime()/1e3,k.awb.hbr_tracking=k.batch.hbr_tracking||null,k.awb.hbr_postal_provider=k.batch.hbr_postal_provider||null,k.batch.paymentStatus&&(k.awb.state=3,k.totalWarehouse>0&&k.totalFlete>0&&p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/payment_success.php",{hbr_tracking:k.awb.hbr_tracking||null,ventaId:k.awb.ventaId,guide_number:k.awb.number||null,arrivalDate:k.awb.arrivalDate||null,estimatedArrivalDate:k.awb.estimatedArrivalDate||null,leaveDate:k.awb.leaveDate||null,hbr_postal_provider:k.awb.hbr_postal_provider||null,email:k.awb.user[0].email||null}).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})}))}function $(){l.showSpinner=!0,k.batch.transfer_total=parseFloat(k.totalButton).toFixed(2),k.awb.paymentMethod=k.batch.paymentMethod.value,k.awb.transfer_account_number=k.batch.transfer_account_number,k.awb.transfer_account_holder_name=k.batch.transfer_account_holder_name,k.awb.transfer_bank_name=k.batch.transfer_bank_name,k.awb.transfer_cbu=k.batch.transfer_cbu,k.awb.transfer_cuit=k.batch.transfer_cuit,k.awb.paymentDesc=k.batch.paymentDesc,k.awb.billing_total=k.batch.transfer_total,k.awb.state=2,k.awb.successUrl=k.batch.successUrl||null,k.awb.paymentButton=k.batch.paymentButton||null,k.awb.paymentMethod&&k.awb.transfer_account_number&&k.awb.transfer_account_holder_name&&k.awb.transfer_bank_name&&k.awb.transfer_cbu&&k.awb.transfer_cuit&&k.awb.billing_total||k.awb.successUrl&&k.awb.paymentButton?p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/payment_method.php",{paymentMethod:k.awb.paymentMethod,ventaId:k.awb.ventaId,guide_number:k.awb.number,paymentButton:String(k.awb.paymentButton),transfer_account_number:k.awb.transfer_account_number,transfer_account_holder_name:k.awb.transfer_account_holder_name,transfer_bank_name:k.awb.transfer_bank_name,transfer_cbu:k.awb.transfer_cbu,transfer_cuit:k.awb.transfer_cuit,paymentDesc:k.awb.paymentDesc,name:k.awb.user.name+" "+k.awb.user.lastname,total:parseFloat(k.totalButton).toFixed(2),email:k.awb.user[0].email}).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})}):3==k.awb.paymentMethod&&p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/payment_method.php",{paymentMethod:k.awb.paymentMethod,ventaId:k.awb.ventaId,guide_number:k.awb.number,paymentButton:String(k.awb.paymentButton),transfer_account_number:k.awb.transfer_account_number,transfer_account_holder_name:k.awb.transfer_account_holder_name,transfer_bank_name:k.awb.transfer_bank_name,transfer_cuit:k.awb.transfer_cuit,transfer_cbu:k.awb.transfer_cbu,paymentDesc:k.awb.paymentDesc,name:k.awb.user.name+" "+k.awb.user.lastname,total:parseFloat(k.totalButton).toFixed(2),email:k.awb.user.email}).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})})}function F(){l.showSpinner=!0,k.awb.arrivalDate=new Date(k.batch.arrivalDate).getTime()/1e3,k.awb.leaveDate=new Date(k.batch.leaveDate).getTime()/1e3,k.awb.state=3,p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/update_dates.php",{ventaId:k.awb.ventaId,guide_number:k.awb.number,arrivalDate:k.awb.arrivalDate,leaveDate:k.awb.leaveDate,estimatedArrivalDate:k.awb.estimatedArrivalDate,email:k.awb.user.email}).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})})}function I(){var e=sessionStorage.getItem("clientType"),t=sessionStorage.getItem("isAdmin");k.isWh=0==t&&2==e}function B(){l.showSpinner=!0,k.awb.wh_leave_date=new Date(k.batch.wh_leave_date).getTime()/1e3,console.log(k.awb),p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/wh_notifications.php",{ventaId:k.awb.ventaId,guide_number:k.awb.number,wh_leave_date:k.awb.wh_leave_date,email:k.awb.warehouse[0].email,name:k.awb.warehouse[0].name,user:k.awb.user[0].name+" "+k.awb.user[0].lastname,action:"whLeaveDate"}).then(function(e){u.post("./hbr-selfie/dist/php/notifications/wh_notifications_user.php",{ventaId:k.awb.ventaId,guide_number:k.awb.number,wh_leave_date:k.awb.wh_leave_date,name:k.awb.warehouse[0].name,email:k.awb.user[0].email,action:"whLeaveDate"}).then(function(){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})})})}function S(){l.showSpinner=!0,k.awb.arrivalDate=new Date(k.batch.arrivalDate).getTime()/1e3,k.awb.leaveDate=new Date(k.batch.leaveDate).getTime()/1e3,p.updateGuide(k.awb).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})}).catch(function(e){console.log(e)})}function C(){l.showSpinner=!0,k.awb.arrivalDate=new Date(k.batch.arrivalDate).getTime()/1e3,k.awb.leaveDate=new Date(k.batch.leaveDate).getTime()/1e3,k.awb.estimatedArrivalDate=new Date(k.batch.estimatedArrivalDate).getTime()/1e3,k.awb.state=4,p.updateGuide(k.awb).then(function(e){u.post("./hbr-selfie/dist/php/notifications/update_dates.php",{ventaId:k.awb.ventaId,guide_number:k.awb.number,arrivalDate:k.awb.arrivalDate,leaveDate:k.awb.leaveDate,estimatedArrivalDate:k.awb.estimatedArrivalDate,email:k.awb.user.email,state:k.awb.state}).then(function(e){l.showSpinner=!1,o.dismiss("cancel"),a.go(a.current,{},{reload:!0})})})}var k=this;!function(){I(),k.saveDates=S,k.updateWhLeaveDate=B,k.markAsDelivered=C,k.cancel=f,l.showSpinner=!1,k.awb=c,k.products=d,k.collapsedWarehouse=!0,k.collapsedFlete=!0,k.generateToken=g,t.shipmentSave="",t.warehouseSave="",k.batch={},k.awb.weight=parseFloat(k.awb.weight).toFixed(2),k.awb.price=parseFloat(k.awb.price).toFixed(2),k.totalTax=[],k.totalWarehouse=parseFloat(k.awb.warehouse_total).toFixed(2),k.totalFlete=parseFloat(k.awb.shipment_total).toFixed(2),k.totalButton=parseFloat(k.awb.billing_total).toFixed(2),k.batch.wh_entry=parseFloat(k.awb.warehouse_enter).toFixed(2),k.batch.adic_kg=parseFloat(k.awb.warehouse_aditional_weight).toFixed(2),k.batch.adic_charges=parseFloat(k.awb.warehouse_aditional_charges).toFixed(2),k.batch.flete_internacional=parseFloat(k.awb.shipment_international).toFixed(2),k.batch.hbr_tracking=k.awb.hbr_tracking,k.batch.hbr_postal_provider=k.awb.hbr_postal_provider,k.updateArrivalDate=F,k.batch.paymentButton=n.trustAsHtml(k.awb.paymentButton),k.batch.successUrl=k.awb.successUrl,t.noCalculated=!0,new Date(0),k.awb.arrivalDate&&(k.batch.arrivalDate=new Date(1e3*k.awb.arrivalDate)),k.awb.leaveDate&&(k.batch.leaveDate=new Date(1e3*k.awb.leaveDate)),k.awb.estimatedArrivalDate&&(k.batch.estimatedArrivalDate=new Date(1e3*k.awb.estimatedArrivalDate)),k.awb.wh_leave_date&&(k.batch.wh_leave_date=new Date(1e3*k.awb.wh_leave_date)),k.batch.paymentStatus=3==k.awb.state||4==k.awb.state,k.calcWarehouse=m,k.calcFlete=b,k.calcButton=_,k.saveShipment=v,k.saveWarehouse=x,k.finishAwb=y,_(k.totalWarehouse,k.totalFlete),w(),k.paymentMethods=[{value:0,name:"-- Select Payment Method --"},{value:1,name:"Todo Pago"},{value:2,name:"Bank Transfer"},{value:3,name:"Cash"}],k.sendPaymentMethod=$,k.batch.paymentMethod={},k.batch.paymentMethod.value=parseInt(k.awb.paymentMethod)||0,k.batch.transfer_account_number=k.awb.transfer_account_number,k.batch.transfer_account_holder_name=k.awb.transfer_account_holder_name,k.batch.transfer_bank_name=k.awb.transfer_bank_name,k.batch.transfer_cbu=k.awb.transfer_cbu,k.batch.transfer_cuit=k.awb.transfer_cuit,k.batch.paymentDesc=k.awb.paymentDesc}()}t.controller("airwayCtrl",a),a.$inject=["$http","$state","airwayService","usersService","$filter","$scope","$uibModal","$sce","$compile"],t.controller("ProcessModalCtrl",r),r.$inject=["$scope","$state","$filter","$uibModalInstance","$uibModal","$sce","$compile","$rootScope","awb","products","$http","airwayService","$q"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s,l,c,d){function u(e,t,a){n.open({templateUrl:"airway-desc.html",backdrop:"static",keyboard:!1,controller:"airwayListModalCtrl",controllerAs:"airwaybill_desc",size:e,resolve:{awb:function(){return t},products:function(){return a}}})}function p(e,t){u("md",e,t)}function h(){$('[rel="payment_button"]').find("a").each(function(e,t){$(t).attr("target","_blank")})}var f=this;!function(){c.showSpinner=!0,f.paymentPending=!1,i.filtered=[],d.checkAuth().then(function(t){f.uid=t.data.uid,r.get_finished_airwaybillsByUserId(f.uid).then(function(t){f.guides=t.data.guideBatch,e.forEach(f.guides,function(e){2==e.state&&1!=e.paymentMethod&&(f.paymentPending=!0),e.paymentButton&&(e.paymentButton=s.trustAsHtml(e.paymentButton))}),c.showSpinner=!1,i.totalItems=Object.keys(f.guides).length,i.currentPage=1,i.itemsPerPage=5,i.maxSize=5,i.setPage=function(e){i.currentPage=e},i.pageChanged=function(){},i.$watch("search",function(e){var t=e;i.filtered=o("filter")(f.guides,t),i.currentPage=1})})}),f.seeMore=p}(),setTimeout(h,300)}function r(e,t,a,r,o,i,n,s,l,c,d,u,p){function h(){r.dismiss("cancel")}var f=this;!function(){f.cancel=h,f.awb=l,console.log(f.awb),f.products=c}()}t.controller("airwayListCtrl",a),a.$inject=["$http","$state","airwayService","$filter","$scope","$uibModal","$sce","$compile","$rootScope","authenticationService"],t.controller("airwayListModalCtrl",r),r.$inject=["$scope","$state","$filter","$uibModalInstance","$uibModal","$sce","$compile","$rootScope","awb","products","$http","airwayService","$q"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(){}t.controller("historyCtrl",a),a.$inject=[]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s,l,c,d){function u(){i.open({templateUrl:"./hbr-selfie/dist/routes/wh-box/shipping/modals/add-box.template.html",controller:"modalAddShippingBoxCtrl",controllerAs:"modalAddShippingBox",size:"sm",backdrop:"static",resolve:{box:function(){return C.shippingBox},boxes:function(){return C.boxes},isEditing:function(){return C.isEditing}}})}function p(e){C.modalInstance=i.open({templateUrl:e,scope:r,size:"sm",backdrop:"static"})}function h(e,a){p("./hbr-selfie/dist/routes/wh-box/shipping/confirm/delete.confirm.html"),r.deleteCancel=function(){C.modalInstance.dismiss("cancel")},r.deleteAccept=function(){t._deleteBox(e).then(function(e){n.go("dashboard.shipping",{},{reload:!0}),C.filteredBoxes.splice(a,1),C.modalInstance.dismiss("cancel")})}}function f(a){r.spbox=e.copy(a),p("./hbr-selfie/dist/routes/wh-box/shipping/confirm/location.confirm.html"),r.locationCancel=function(){a.warehouse_location=a.baseLocation,C.spinner=!1,C.modalInstance.dismiss("cancel")},r.locationAccept=function(){a.baseLocation=a.warehouse_location,a.wh_arrival_date=r.spbox.wh_arrival_date||a.wh_arrival_date||null,a.wh_leave_date=r.spbox.wh_leave_date||a.wh_leave_date||null,a.wh_provider=r.spbox.wh_provider||a.wh_provider||a.provider||null,a.wh_tracking=r.spbox.wh_tracking||a.wh_tracking||a.tracking||null,a.travel_status=1,t._editWarehouseLocation(a).then(function(e){r.spbox={},C.spinner=!1,C.modalInstance.dismiss("cancel"),n.go("dashboard.shipping",{},{reload:!0})})}}function g(){C.isEditing=!1,u()}function m(e){C.isEditing=!0,C.shippingBox=e,u()}function b(e,t){C.filterName=t,C.filterQuery=e,"ageGreater"!==C.filterQuery&&"ageLess"!==C.filterQuery||(C.filterQueryCondition=C.filterQuery,C.filterQuery="age")}function _(){C.searchBy&&C.filterQuery&&(C.multipleFilter.push({filterQuery:C.filterQuery,filterName:C.filterName,searchBy:C.searchBy}),C.searchBy="",C.filterQuery="",C.searchBy="",C.filterName=C.boxLang.room.filter.default,w())}function w(){C.multipleFilter.forEach(function(e){C.filteredBoxes=C.filteredBoxes.filter(function(t){if("age"===e.filterQuery)if("ageGreater"===C.filterQueryCondition){if(parseInt(t[e.filterQuery])>=parseInt(e.searchBy))return t}else if("ageLess"===C.filterQueryCondition&&parseInt(t[e.filterQuery])<=parseInt(e.searchBy))return t;if("company_name"!==e.filterQuery&&"warehouse_name"!==e.filterQuery&&"age"!==e.filterQuery){if(t[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("company_name"===e.filterQuery){if(t.user[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("warehouse_name"===e.filterQuery&&t.warehouse.name.toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t})})}function v(e){C.multipleFilter.splice(e,1),C.filteredBoxes=C.boxes,w()}function x(){1==C.isAdmin||2==C.clientType?t._getAllShippingBox().then(function(t){C.boxes=t.data.boxes,C.boxes.forEach(function(t){var a=moment(new Date(parseInt(t.created)));t.age=moment().diff(a,"days"),t.total=S(t),t.baseLocation=e.copy(t.warehouse_location)}),C.filteredBoxes=e.copy(C.boxes),r.totalItems=Object.keys(C.filteredBoxes).length,r.currentPage=1,r.itemsPerPage=5,r.maxSize=5,r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){},r.$watch("searchBy",function(e){var t=e;r.filtered=s("filter")(C.filteredBoxes,t),r.currentPage=1})}).catch(function(e){console.log(e)}):t._getBoxesByUserId().then(function(t){C.boxes=t.data.boxes,C.boxes.forEach(function(t){var a=moment(new Date(parseInt(t.created)));t.age=moment().diff(a,"days"),t.total=S(t),t.baseLocation=e.copy(t.warehouse_location)}),C.filteredBoxes=e.copy(C.boxes),r.totalItems=Object.keys(C.filteredBoxes).length,r.currentPage=1,r.itemsPerPage=5,r.maxSize=5,r.setPage=function(e){r.currentPage=e},r.pageChanged=function(){},r.$watch("searchBy",function(e){var t=e;r.filtered=s("filter")(C.filteredBoxes,t),r.currentPage=1})}).catch(function(e){console.log(e)})}function y(e){C.prevBox=e}function $(e){t._editTravelStatus(e)}function F(a,o){var i=e.copy(o.status);r.spbox=o,r.spbox.toStatus=a,o.status!=a&&o.id==C.prevBox?(p("./hbr-selfie/dist/routes/wh-box/shipping/confirm/status.confirm.html"),r.statusCancel=function(){o.status=i,C.spinner=!1,C.modalInstance.dismiss("cancel")},r.statusAccept=function(){o.status=a,o=r.spbox,o.travel_status=1,0!=a&&1!=a||(o.wh_tracking=r.confirmBox.tracking||o.wh_tracking||null,o.tracking=r.confirmBox.tracking||o.tracking||null,o.wh_provider=r.confirmBox.provider||o.wh_provider||null,o.provider=r.confirmBox.provider||o.provider||null,0==a&&(o.wh_arrival_date=r.confirmBox.arrival_date||o.wh_arrival_date||null,o.arrival_date=r.confirmBox.arrival_date||o.arrival_date||null,o.wh_leave_date=r.confirmBox.leave_date||o.wh_leave_date||null,o.leave_date=r.confirmBox.leave_date||o.leave_date||null),1==a&&(o.bsas_arrival_date=r.confirmBox.arrival_date||o.bsas_arrival_date||null,o.arrival_date=r.confirmBox.arrival_date||o.arrival_date||null,o.wh_leave_date=r.confirmBox.leave_date||o.wh_leave_date||null,o.leave_date=r.confirmBox.leave_date||o.leave_date||null)),2==a&&(o.bsas_tracking=r.confirmBox.tracking||o.bsas_tracking||null,o.tracking=r.confirmBox.tracking||o.tracking||null,o.bsas_provider=r.confirmBox.provider||o.bsas_provider||null,o.provider=r.confirmBox.provider||o.provider||null,o.customer_arrival_date=r.confirmBox.arrival_date||o.customer_arrival_date||null,o.arrival_date=r.confirmBox.arrival_date||o.arrival_date||null,o.bsas_leave_date=r.confirmBox.leave_date||o.bsas_leave_date||null,o.leave_date=r.confirmBox.leave_date||o.leave_date||null),t._editShippingBox(o).then(function(){r.confirmBox={},C.spinner=!1,C.modalInstance.dismiss("cancel"),n.go("dashboard.shipping",{},{reload:!0})})}):o.status=i}function I(e,t){}function B(e){r.hovered="",n.go("dashboard.stock_rooms",{spBoxId:e.id},{reload:!0})}function S(e){var t={weight:0,value:0,quantity:0,wh_val:0,wh_aditional_val:0};return e.enter_box.forEach(function(e){t.weight=parseFloat(t.weight)+parseFloat(e.box_partial_weight),t.value=parseFloat(t.value)+parseFloat(e.box_partial_value),t.quantity=parseInt(t.quantity)+parseInt(e.quantity),t.wh_val=parseFloat(t.wh_val)+parseFloat(e.box_warehouse_value),t.wh_aditional_val=parseFloat(t.wh_aditional_val)+parseFloat(e.aditional_total)}),t}var C=this;!function(){r.confirmBox={},C.deleteBox=h,C.updateTravelStatus=$,C.saveLocation=f,C.shippingBox={},C.dragLeave=y,C.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),C.clientType=parseInt(sessionStorage.getItem("clientType")),C.lang=o.langs.shipping,C.boxLang=o.langs.stock_rooms,C.filterName=C.boxLang.room.filter.default,r.$watch("$root.langs",function(){C.lang=o.langs.shipping,l.get("./hbr-selfie/dist/php/warehouse.php",{params:{action:"getAll"}}).then(function(e){C.warehouses=e.data.warehouses})}),C.boxLang=o.langs.stock_rooms,r.$watch("$root.langs",function(){C.boxLang=o.langs.stock_rooms,C.filterName=C.boxLang.room.filter.default}),C.boxes=[],x(C.isAdmin),C.dragEnter=F,C.notify=I,C.navigate=B,C.multipleFilter=[],C.room={},C.removeFilter=v,C.searchBy="",C.filterQuery="",C.setFilter=b,C.applyFilter=_,C.filteredBoxes=[],C.addBox=g,C.editBox=m}()}function r(t,a,r,o,i,n,s,l,c,d,u,p,h,f,g){function m(){S.spinner=!1,s.dismiss("cancel")}function b(e){S.trackingBoxes=[],S.selectedTrackingBox=!1,S.isEditing||(S.box_list.forEach(function(e){e.isActive=!1}),e.isActive=!0,S.selectedBox=!0,S.trackingBoxes=S.boxes.filter(function(t){if(t.tracking===e.tracking)return t}))}function _(e){S.isEditing||(S.trackingBoxes.forEach(function(e){e.isActive=!1}),e.isActive=!0,S.selectedTrackingBox=!0,S.box=e)}function w(e,t){for(var a,r=[],o=[],i=0;i<e.length;i++)a=e[i][t],-1===o.indexOf(a)&&(r.push(e[i]),o.push(a));return r}function v(a){S.box_list=[],S.boxes=[],S.trackingBoxes=[],S.selectedBox=!1,r.checkAuth().then(function(r){var o=parseInt(r.data.uid);t._getAllEnterBoxes().then(function(t){S.box_list=t.data.boxes.filter(function(e){if(a&&e.user.id==a.id)if(2==S.clientType){if(e.warehouse.id==o)return e}else if(S.isAdmin)return e}),S.boxes=e.copy(t.data.boxes),S.box_list=w(S.box_list,"tracking"),Object.keys(S.box).length&&S.box_list.filter(function(e){e.id==S.box.awb_boxes_id?(e.isActive=!0,S.selectedBox=!0,S.box.bills=e.bills):e.isActive=!1})})})}function x(e){e.status=2,e.user.tel=e.user.tel+" / "+e.user.cel,S.shippingBox.user=e.user,S.shippingBox.boxes.push(e),y()}function y(){S.shippingBox.total.weight=0,S.shippingBox.total.value=0,S.shippingBox.total.quantity=0,S.shippingBox.total.wh_val=0,S.shippingBox.total.wh_aditional_val=0,S.shippingBox.boxes.forEach(function(e){S.shippingBox.total.weight=parseFloat(S.shippingBox.total.weight)+parseFloat(e.box_partial_weight),S.shippingBox.total.value=parseFloat(S.shippingBox.total.value)+parseFloat(e.box_partial_value),S.shippingBox.total.quantity=parseInt(S.shippingBox.total.quantity)+parseInt(e.quantity),S.shippingBox.total.wh_val=parseFloat(S.shippingBox.total.wh_val)+parseFloat(e.box_warehouse_value),S.shippingBox.total.wh_aditional_val=parseFloat(S.shippingBox.total.wh_aditional_val)+parseFloat(e.aditional_total)})}function F(e,t){S.boxes.filter(function(t){t.id===e.id&&(t.status=1)}),S.shippingBox.boxes.splice(t,1),y()}function I(){a._addShippingBox(S.shippingBox).then(function(e){var t=e.data.id;if(e.data.success&&t){var r=g.defer();r.resolve(),r=r.promise,S.shippingBox.boxes.forEach(function(e){r=r.then(function(){return e.shipping_box_id=t,a._updateEnterBox(e)})}),g.all(r).then(function(){setTimeout(function(){S.spinner=!1,s.dismiss("cancel"),i.go("dashboard.shipping",{},{reload:!0})},3e3)})}})}function B(e){var t=parseInt(e)+1;S.tabs[t].disabled=!1,S.tabActive=parseInt(e)+2,$("html, body").animate({scrollTop:0},500)}var S=this;o.getFilename=function(e){var e=e.files[0];e?"application/pdf"===e.type||"image/png"===e.type||"image/jpeg"===e.type?(S.bill.hasFile=!0,S.billIsValid()):(S.bill.hasFile=!1,S.bill.fileError=S.lang.form.fileError,S.billIsValid()):(S.bill.hasFile=!1,S.billIsValid())},function(){S.shippingBox={total:{weight:0,value:0,quantity:0,wh_val:0,wh_aditional_val:0},user:{},boxes:[],freight_val:"0.00",shipping_val:"0.00",warehouse_val:"0.00",aditional_unit:"0",aditional_value:"0.00",aditional_total:"0.00",tracking:"",provider:"",bill_file:""},S.shippingBox.user&&(S.selectedUser=S.shippingBox.user,v(S.shippingBox.user)),S.finish=I,S.cancel=m,S.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),S.clientType=parseInt(sessionStorage.getItem("clientType")),S.spinner=!1,S.searchBy="",S.filterQuery="",S.filteredBoxes=[],S.trackingBoxes=[],S.boxes=[],S.box=d||{},S.baseBox=e.copy(d),S.getBoxList=v,S.setBox=_,S.setTrackingBox=b,S.box_list=[],S.selectedBox=!1,S.isEditing=p||!1,S.boxLang={},S.nextStep=B,S.toShippingBox=x,S.deleteSPBox=F,S.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),S.lang=h.langs.shipping,S.tabs=[{title:S.lang.form.add.tab_wh,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/box.form.html",helpText:""},{title:S.lang.form.add.tab_shipping_box,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/shipping-box.form.html",helpText:"",disabled:!S.shippingBox.boxes.length},{title:S.lang.form.add.tab_shipping_info,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/shipping-info.form.html",helpText:"",disabled:!S.shippingBox.boxes.length}],Object.keys(S.box).length?S.lang.form.title=S.lang.form.edit.title:S.lang.form.title=S.lang.form.add.title,f.get("./hbr-selfie/dist/php/users.php",{params:{client_type:"1",action:"getAll"}}).then(function(e){S.users=e.data.users,S.box.user&&(S.selectedUser=S.box.user,v(S.selectedUser))}),o.$watch("$root.langs",function(){S.savedTab=S.tabActive,S.lang=h.langs.shipping,S.tabs=[{title:S.lang.form.add.tab_wh,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/box.form.html",helpText:""},{title:S.lang.form.add.tab_shipping_box,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/shipping-box.form.html",helpText:"",disabled:!S.shippingBox.boxes.length},{title:S.lang.form.add.tab_shipping_info,content:"hbr-selfie/dist/routes/wh-box/shipping/modals/shipping-info.form.html",helpText:"",disabled:!S.shippingBox.boxes.length}],S.tabActive=S.savedTab,Object.keys(S.box).length?S.lang.form.title=S.lang.form.edit.title:S.lang.form.title=S.lang.form.add.title,f.get("./hbr-selfie/dist/php/users.php",{params:{client_type:"1",action:"getAll"}}).then(function(e){S.users=e.data.users,S.box.user&&(S.selectedUser=S.box.user,v(S.selectedUser))})}),S.boxLang=h.langs.stock_rooms,o.$watch("$root.langs",function(){S.boxLang=h.langs.stock_rooms,S.filterName=S.boxLang.room.filter.default})}()}t.controller("shippingCtrl",a),a.$inject=["shippingService","boxService","$scope","$rootScope","$uibModal","$state","$filter","$http","$sce","$compile"],t.controller("modalAddShippingBoxCtrl",r),r.$inject=["boxService","shippingService","authenticationService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","box","boxes","isEditing","$rootScope","$http","$q"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n,s,l){function c(e,t){v.filterName=t,v.filterQuery=e,"ageGreater"!==v.filterQuery&&"ageLess"!==v.filterQuery||(v.filterQueryCondition=v.filterQuery,v.filterQuery="age")}function d(){v.searchBy&&v.filterQuery&&(v.multipleFilter.push({filterQuery:v.filterQuery,filterName:v.filterName,searchBy:v.searchBy}),v.searchBy="",v.filterQuery="",v.searchBy="",v.filterName=v.lang.room.filter.default,u())}function u(){v.multipleFilter.forEach(function(e){v.filteredBoxes=v.filteredBoxes.filter(function(t){if("age"===e.filterQuery)if("ageGreater"===v.filterQueryCondition){if(parseInt(t[e.filterQuery])>=parseInt(e.searchBy))return t}else if("ageLess"===v.filterQueryCondition&&parseInt(t[e.filterQuery])<=parseInt(e.searchBy))return t;if("company_name"!==e.filterQuery&&"warehouse_name"!==e.filterQuery&&"age"!==e.filterQuery&&"status"!==e.filterQuery&&"id"!==e.filterQuery){if(t[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("company_name"===e.filterQuery){if(t.user[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("warehouse_name"===e.filterQuery){if(t.warehouse.name.toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("id"===e.filterQuery){if(t[e.filterQuery]==e.searchBy)return t}else if("status"===e.filterQuery){if(("Completo"==e.searchBy||"Completed"==e.searchBy)&&1==t.status)return t;if(("En progreso"==e.searchBy||"In Progress"==e.searchBy)&&0==t.status)return t}})}),v.room=i.calculate_room(v.filteredBoxes)}function p(e){v.multipleFilter.splice(e,1),v.filteredBoxes=v.boxes,u()}function h(e){e=e||{};n.open({templateUrl:"./hbr-selfie/dist/routes/wh-box/stock-rooms/modals/add-box.template.html",controller:"modalAddBoxCtrl",controllerAs:"modalAddBox",backdrop:"static",size:"sm",resolve:{box:e,isEditing:v.isEditing}})}function f(){v.isEditing=!1,h()}function g(e){v.isEditing=!0,h(e)}function m(t,a){a.real_remaining=parseInt(a.real_remaining)+parseInt(a.quantity),i._deleteEnterBox(a).then(function(){e.element(".footer")[0].click(),i.calculate_room(),v.filteredBoxes.splice(t,1),v.boxes.filter(function(e){e.id===a.id&&v.boxes.splice(e,1)})})}function b(t,a){a.status=1,i._finishEnterBox(a).then(function(){e.element(".footer")[0].click()})}function _(){e.element(".footer")[0].click()}function w(t){l.checkAuth().then(function(a){var r=parseInt(a.data.uid);i._getAllEnterBoxes().then(function(a){v.boxes=a.data.boxes,0==t&&(2==v.clientType?v.boxes=v.boxes.filter(function(e){if(e.warehouse.id==r)return e}):v.boxes=v.boxes.filter(function(e){if(e.user.id==r)return e})),v.boxes.forEach(function(e){var t=moment(new Date(parseInt(e.created)));e.age=moment().diff(t,"days")}),v.filteredBoxes=e.copy(v.boxes),v.room=i.calculate_room(v.filteredBoxes),s.params.boxId&&(c("awb_boxes_id",v.lang.room.filter.list.awb_boxes_id),v.searchBy=s.params.boxId,d()),s.params.spBoxId&&(c("shipping_box_id",v.lang.room.filter.list.shipping_box_id),v.searchBy=s.params.spBoxId,d())}).catch(function(e){console.log(e)})})}var v=this;!function(){v.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),v.clientType=parseInt(sessionStorage.getItem("clientType")),v.lang=a.langs.stock_rooms,t.$watch("$root.langs",function(){v.lang=a.langs.stock_rooms,v.filterName=v.lang.room.filter.default}),v.isEditing=!1,v.boxes=[],v.multipleFilter=[],v.room={},v.removeFilter=p,v.searchBy="",v.filterQuery="",v.setFilter=c,v.applyFilter=d,v.filteredBoxes=[],v.addBox=f,v.editBox=g,v.deleteBox=m,v.finishBox=b,v.cancelDeleteBox=_,w(v.isAdmin)}()}function r(t,a,r,o,i,n,s,l,c,d,u,p,h){function f(){w.spinner=!1,s.dismiss("cancel")}function g(){w.spinner=!0,w.box.aditional_total=parseInt(w.box.aditional_unit||0)*parseFloat(w.box.aditional_value||0),u?t._editEnterBox(w.box,w.baseBox).then(function(e){e.data.success&&(w.spinner=!1,i.go("dashboard.stock_rooms",{},{reload:!0}),s.dismiss("cancel"))}):t._addEnterBox(w.box).then(function(e){e.data.success&&(w.spinner=!1,i.go("dashboard.stock_rooms",{},{reload:!0}),s.dismiss("cancel"))})}function m(e){w.isEditing||(w.box_list.forEach(function(e){e.isActive=!1}),e.isActive=!0,w.selectedBox=!0,w.box=e)}function b(){w.updatingRealValues=!0,r._updateRealValues(w.box).then(function(e){w.updatingRealValues=!1})}function _(e){w.selectedBox=!1,a.checkAuth().then(function(t){r._getAllAwbBoxes().then(function(a){var r=parseInt(t.data.uid);0==t.data.isAdmin?w.box_list=a.data.awb_boxes.filter(function(t){if(t.uid==e.id&&t.warehouse.id==r)return t}):w.box_list=a.data.awb_boxes,w.box&&w.box_list.filter(function(e){e.id==w.box.awb_boxes_id?(e.isActive=!0,w.selectedBox=!0,w.box.bills=e.bills):e.isActive=!1})})})}var w=this;!function(){w.box=d||{},w.baseBox=e.copy(d),w.getBoxList=_,w.setBox=m,w.box_list=[],w.selectedBox=!1,w.isEditing=u,w.cancel=f,w.addBox=g,w.spinner=!1,w.updateRealValues=b,w.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),w.lang=p.langs.stock_rooms,o.$watch("$root.langs",function(){w.lang=p.langs.stock_rooms,Object.keys(d).length?(w.box.box_value=parseFloat(d.box_value),w.box.box_stock=parseInt(d.box_stock),w.box.box_weight=parseFloat(d.box_weight),w.box.box_warehouse_value=parseFloat(d.box_warehouse_value),w.box.real_box_value=d.real_box_value||parseFloat(d.box_value),w.box.real_box_stock=d.real_box_stock||parseInt(d.box_stock),w.box.real_box_weight=d.real_box_weight||parseFloat(d.box_weight),w.box.real_remaining=d.real_remaining||parseFloat(d.box_stock),w.box.aditional_unit=parseInt(d.aditional_unit)||"0",w.box.aditional_value=parseFloat(d.aditional_value)||"0.00",w.box.aditional_total=parseFloat(d.aditional_total)||"0.00",w.box.whId=d.warehouse,w.lang.form.title=w.lang.form.edit.title):w.lang.form.title=w.lang.form.add.title,h.get("./hbr-selfie/dist/php/users.php",{params:{client_type:"1",action:"getAll"}}).then(function(e){w.users=e.data.users,w.box.user&&(w.selectedUser=w.box.user,_(w.selectedUser))})})}()}t.controller("stockRoomsCtrl",a),a.$inject=["$scope","$rootScope","$filter","$http","boxService","$uibModal","$state","authenticationService"],t.controller("modalAddBoxCtrl",r),r.$inject=["boxService","authenticationService","awbboxService","$scope","$state","$filter","$uibModalInstance","$sce","$compile","box","isEditing","$rootScope","$http"]}e.exports=a},function(e,t){function a(e,t){"use strict";"use angular template";function a(t,a,r,o,i,n){function s(e,t){_.filterName=t,_.filterQuery=e,"ageGreater"!==_.filterQuery&&"ageLess"!==_.filterQuery||(_.filterQueryCondition=_.filterQuery,_.filterQuery="age")}function l(e){e=e||{};i.open({templateUrl:"./hbr-selfie/dist/routes/wh-box/awb-box/modals/add-box.template.html",controller:"modalCtrl",controllerAs:"modal",backdrop:"static",scope:a,size:"sm",resolve:{box:e,isEditing:_.isEditing}})}function c(){l()}function d(e){_.isEditing=!0,l(e)}function u(){_.searchBy&&_.filterQuery&&(_.multipleFilter.push({filterQuery:_.filterQuery,filterName:_.filterName,searchBy:_.searchBy}),_.searchBy="",_.filterQuery="",_.searchBy="",_.filterName=a.lang.filter.default,p())}function p(){_.searched=!0,_.multipleFilter.forEach(function(e){_.filteredBoxes=_.boxes.filter(function(t){if("company_name"!==e.filterQuery&&"warehouse_name"!==e.filterQuery&&"age"!==e.filterQuery&&"bill"!==e.filterQuery){if(t[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("company_name"===e.filterQuery){if(t.user[e.filterQuery].toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("warehouse_name"===e.filterQuery){if(t.warehouse.name.toString().toLowerCase().includes(e.searchBy.toLowerCase()))return t}else if("age"===e.filterQuery){if("ageGreater"===_.filterQueryCondition){if(parseInt(t[e.filterQuery])>=parseInt(e.searchBy))return t}else if("ageLess"===_.filterQueryCondition&&parseInt(t[e.filterQuery])<=parseInt(e.searchBy))return t}else if("bill"===e.filterQuery){var a=!1;if(t.bills.some(function(t){t.number==e.searchBy&&(a=!0)}),a)return t}})})}function h(t){_.multipleFilter.splice(t,1),_.multipleFilter.length?(_.filteredBoxes=[],p()):_.filteredBoxes=e.copy(_.boxes),_.filteredBoxes.length||(_.searched=!1)}function f(e){o.go("dashboard.stock_rooms",{boxId:e.id},{reload:!0})}function g(a){a||"2"==_.clientType?t._getAllAwbBoxes().then(function(t){_.boxes=t.data.awb_boxes,_.filteredBoxes=e.copy(_.boxes)}):t._getAwbBoxesByUserId().then(function(t){_.boxes=t.data.awb_boxes,_.filteredBoxes=e.copy(_.boxes)})}function m(){e.element(".awb-card_footer")[0].click()}function b(a,r){t._deleteBox(r).then(function(){if(r.bills.length){var i=n.defer();i.resolve(),i=i.promise,e.forEach(r.bills,function(e){i=i.then(function(){return t._deleteBill(e)})}),n.all(i).then(function(){e.element(".awb-card_footer")[0].click(),_.filteredBoxes.splice(a,1),_.boxes.filter(function(e){e.id===r.id&&_.boxes.splice(e,1)})})}else o.go("dashboard.awb-box",{},{reload:!0})})}var _=this;!function(){_.searched=!1,_.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),_.clientType=parseInt(sessionStorage.getItem("clientType")),a.lang=r.langs.awb_box,_.filterName=a.lang.filter.default,a.$watch("$root.langs",function(){a.lang=r.langs.awb_box,_.filterName=a.lang.filter.default}),_.boxes=[],_.spinner=!1,_.multipleFilter=[],_.removeFilter=h,_.searchBy="",_.filterQuery="",_.setFilter=s,_.applyFilter=u,_.filteredBoxes=[],a.navigate=f,_.addBox=c,a.editBox=d,_.cancelDeleteBox=m,_.deleteBox=b,g(_.isAdmin)}()}function r(t,a,r,o,i,n,s,l,c,d){function u(){B.spinner=!1,B.box.bills=B.billCopy,i.dismiss("cancel"),o.go("dashboard.awb-box",{},{reload:!0})}function p(e){var t=!0;return e=e||null,B.billSubmitted&&(B.bill.number.length||null!=e&&"bill-number"!=e?B.errors.bills.number="":(t=!1,B.errors.bills.number=B.lang.form.errors.bills.number.required),B.bill.value&&(0!=B.bill.value||null!=e&&"bill-value"!=e)?B.errors.bills.value="":(t=!1,B.errors.bills.value=B.lang.form.errors.bills.value.required),B.bill.long_desc.length||null!=e&&"bill-long_desc"!=e?B.errors.bills.long_desc="":(t=!1,B.errors.bills.long_desc=B.lang.form.errors.bills.long_desc.required),B.bill.stock&&(0!=B.bill.stock||null!=e&&"bill-stock"!=e)?B.errors.bills.stock="":(t=!1,B.errors.bills.stock=B.lang.form.errors.bills.stock.required)),t}function h(e){var t=!0;return e=e||null,B.boxForm.$submitted&&(B.box.provider&&(B.box.provider.length||null!=e&&"box-provider"!=e)?B.errors.provider="":(t=!1,B.errors.provider=B.lang.form.errors.provider.required),B.box.tracking&&(B.box.tracking.length||null!=e&&"box-tracking"!=e)?B.errors.tracking="":(t=!1,B.errors.tracking=B.lang.form.errors.tracking.required),B.box.whId&&(!B.box.whId||B.box.whId.id||null!=e&&"box-warehouse"!=e)?B.errors.warehouse="":(t=!1,B.errors.warehouse=B.lang.form.errors.warehouse.required),B.box.bills.length?B.errors.billsQty="":(t=!1,B.errors.billsQty=B.lang.form.errors.billsQty.required)),t}function f(){B.boxForm.$submitted=!0,h()?(r.invalidBox=!1,B.spinner=!0,B.box.user&&B.box.user.id&&(B.box.uid=B.box.user.id),t._addAwbBox(B.box).then(function(a){if(a.data.success){var r=[];e.forEach(B.box.bills,function(e){r.push(t._addBills(e,a.data.boxId))}),Promise.all(r).then(function(e){B.spinner=!1,i.dismiss("cancel"),o.go("dashboard.awb-box",{},{reload:!0})})}})):(e.element(".modal").scrollTop(0),r.invalidBox=!0)}function g(){B.spinner=!0,B.box.status=0;var a=!1;h()&&(B.box.user&&B.box.user.id&&(B.box.uid=B.box.user.id),t._editBox(B.box).then(function(r){if(r.data.success&&B.box.bills.length){var n=d.defer();n.resolve(),n=n.promise,e.forEach(B.box.bills,function(e){e.id||(a=!0,n=n.then(function(){return t._addBills(e,B.box.id)}))}),B.isEditing&&a?d.all(n).then(function(){B.spinner=!1,setTimeout(function(){i.dismiss("cancel"),o.go("dashboard.awb-box",{},{reload:!0})},1e3)}):(B.spinner=!1,i.dismiss("cancel"),o.go("dashboard.awb-box",{},{reload:!0}))}else i.dismiss("cancel"),o.go("dashboard.awb-box",{},{reload:!0})}))}function m(){p()?(r.invalidBill=!1,B.billSubmitted=!1,r.billEditing=!0,B.box.box_value=0,B.box.box_weight=0,B.box.box_stock=0,B.box.bills.forEach(function(e){B.box.box_value=parseFloat(parseFloat(B.box.box_value)+parseFloat(e.value)).toFixed(2),B.box.box_weight=parseFloat(parseFloat(B.box.box_weight||0)+parseFloat(e.weight||0)).toFixed(2),B.box.box_stock=parseInt(B.box.box_stock)+parseInt(e.stock)}),t._editBox(B.box).then(function(e){t._editBill(B.bill).then(function(){r.billEditing=!1,B.bill=new _,B.errors.bills=B.errors.bills=new x,B.isValid=!0,$("#bill_file").val(""),B.billAction=B.lang.form.add.bill.button,B.billEdit=!1})})):(r.billEditing=!1,r.invalidBill=!0)}function b(){B.billSubmitted=!0,p()?(r.invalidBill=!1,B.billSubmitted=!1,B.box.box_value=parseFloat(parseFloat(B.box.box_value)+parseFloat(B.bill.value)).toFixed(2),B.box.box_weight=parseFloat(parseFloat(B.box.box_weight||0)+parseFloat(B.bill.weight||0)).toFixed(2),B.box.box_stock=parseInt(B.box.box_stock)+parseInt(B.bill.stock),B.box.bills.push(B.bill),B.bill=new _,B.errors.bills=B.errors.bills=new x,B.isValid=!0,$("#bill_file").val("")):r.invalidBill=!0,h()}function _(){this.number="",this.value=0,this.weight=0,this.stock=0,this.bill_file="",this.long_desc="",this.hasFile=!1}function w(e){this.box_value=e.box_value||0,this.box_weight=e.box_weight||0,this.box_stock=e.box_stock||0,this.tracking=e.tracking||"",this.provider=e.provider||"",this.bills=e.bills||[],this.whId=e.warehouse||{},this.user=e.user||{},e.id&&(this.id=e.id)}function v(){var e=this;e.provider="",e.tracking="",e.warehouse="",e.billsQty="",e.bills=new x}function x(){var e=this;e.number="",e.value="",e.long_desc="",e.stock="",e.files=""}function y(e,a){B.billAction=B.lang.form.add.bill.button,B.billEdit=!1,B.isEditing?t._deleteBill(a).then(function(){B.box.bills.splice(e,1),B.box.box_value=parseFloat(parseFloat(B.box.box_value)-parseFloat(a.value)).toFixed(2),B.box.box_weight=parseFloat(parseFloat(B.box.box_weight)-parseFloat(a.weight)).toFixed(2),B.box.box_stock=parseInt(B.box.box_stock)-parseInt(a.stock),t._editBox(B.box)}):(B.box.bills.splice(e,1),B.box.box_value=parseFloat(parseFloat(B.box.box_value)-parseFloat(a.value)).toFixed(2),B.box.box_weight=parseFloat(parseFloat(B.box.box_weight)-parseFloat(a.weight)).toFixed(2),B.box.box_stock=parseInt(B.box.box_stock)-parseInt(a.stock)),h()}function F(e,t){t.value=parseFloat(t.value),t.weight=parseFloat(t.weight),t.stock=parseInt(t.stock),B.bill=t,B.billEdit=!0,B.billAction=B.lang.form.edit.bill.button,$("#bill_file").val("")}function I(){B.bill={},B.billAction=B.lang.form.add.bill.button,$("#bill_file").val(""),B.billEdit=!1}var B=this;r.getFilename=function(e){var e=e.files[0];e?"application/pdf"===e.type||"image/png"===e.type||"image/jpeg"===e.type?(B.bill.hasFile=!0,B.billIsValid()):(B.bill.hasFile=!1,B.bill.fileError=B.lang.form.fileError,B.billIsValid()):(B.bill.hasFile=!1,B.billIsValid())},function(){B.billSubmitted=!1,B.box=new w(n),B.billCopy=e.copy(B.box.bills)||[],B.isEditing=s,B.cancel=u,B.addBox=f,B.cancelEdit=I,B.bill=new _,B.spinner=!1,B.addBill=b,B.editBill=m,B.prepareEditBill=F,B.errors=new v,B.boxIsValid=h,B.billIsValid=p,B.hasFile=!1,B.bill.fileError="",B.removeBill=y,B.edit=g,B.isAdmin=parseInt(sessionStorage.getItem("isAdmin")),B.clientType=parseInt(sessionStorage.getItem("clientType")),B.lang=l.langs.awb_box,r.$watch("$root.langs",function(){B.lang=l.langs.awb_box,B.lang.hide_show=B.collapse?B.lang.show_menu:B.lang.hide_menu,B.billAction=B.lang.form.add.bill.button,B.billEdit=!1,Object.keys(n).length?(B.box.box_value=parseFloat(n.box_value),B.box.box_stock=parseInt(n.box_stock),B.box.box_weight=parseFloat(n.box_weight),B.box.whId=n.warehouse,B.lang.form.title=B.lang.form.edit.title):B.lang.form.title=B.lang.form.add.title,c.get("./hbr-selfie/dist/php/warehouse.php",{params:{action:"getAll"}}).then(function(e){B.warehouses=e.data.warehouses}),c.get("./hbr-selfie/dist/php/users.php",{params:{action:"getAll",client_type:1}}).then(function(e){B.users=e.data.users})})}()}t.controller("awbBoxCtrl",a),a.$inject=["awbboxService","$scope","$rootScope","$state","$uibModal","$q"],t.controller("modalCtrl",r),r.$inject=["awbboxService","authenticationService","$scope","$state","$uibModalInstance","box","isEditing","$rootScope","$http","$q"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this.checkAuth=function(){return e.post("./hbr-selfie/dist/php/session.php",{sskey:sessionStorage.getItem("sskey")})},this.login=function(a){t.defer();return e.get("./hbr-selfie/dist/php/users.php",{params:{username:a.username,password:a.password,action:"login"}})},this.logout=function(){return e.post("./hbr-selfie/dist/php/users.php",{sskey:sessionStorage.getItem("sskey"),method:"POST",action:"logout"})},this.register=function(a){t.defer();return e.post("./hbr-selfie/dist/php/users.php",{name:a.name,lastname:a.lastname,tel:a.tel,cel:a.cel,codeType:a.codeType.toString(),idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalCode:a.postalCode,password:a.password,password2:a.password2,method:"POST",action:"register"})},this.registerCompany=function(a){t.defer();return e.post("./hbr-selfie/dist/php/users.php",{company_name:a.company_name,company_real_name:a.company_real_name,name:a.name,lastname:a.lastname,tel:a.tel,cel:a.cel,codeType:a.codeType.toString(),idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalCode:a.postalCode,password:a.password,password2:a.password2,method:"POST",action:"register"})}}t.service("authenticationService",a),a.$inject=["$http","$q"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){function a(){this.weight=0,this.stock=0,this.room_val=0,this.shipping_val=0,this.warehouse_val=0}this._getLang=function(){var t=(parseInt(sessionStorage.getItem("isAdmin")),parseInt(sessionStorage.getItem("clientType")),sessionStorage.getItem("lang"));return e.get("./hbr-selfie/dist/routes/wh-box/stock-rooms/i18n.json").then(function(e){return e.data[t]})},this._getAllBoxes=function(){return e.get("./hbr-selfie/dist/php/box/get_all_boxes.php")},this.calculate_room=function(e){var t=new a;return e.forEach(function(e){t.weight=e.box_weight?(parseFloat(t.weight)+parseFloat(e.box_partial_weight)).toFixed(2):t.weight,t.stock=e.quantity?parseInt(t.stock)+parseInt(e.quantity):t.stock,t.room_val=e.box_value?(parseFloat(t.room_val)+parseFloat(e.box_partial_value)).toFixed(2):t.room_val,t.shipping_val=e.box_shipping_value?(parseFloat(t.shipping_val)+parseFloat(e.box_shipping_value)).toFixed(2):t.shipping_val,t.warehouse_val=e.box_warehouse_value?(parseFloat(t.warehouse_val)+parseFloat(e.box_warehouse_value)).toFixed(2):t.warehouse_val}),t},this._getBoxesByUserId=function(){return t.checkAuth().then(function(t){if(0==t.data.isAdmin){var a=parseInt(t.data.uid);return e.get("./hbr-selfie/dist/php/box/get_by_uid.php",{params:{uid:a}})}})},this._getBoxById=function(t){return e.get("./hbr-selfie/dist/php/box/add.php",{params:{boxId:t}})},this._addEnterBox=function(a){return t.checkAuth().then(function(t){return a.uid=parseInt(t.data.uid),e.post("./hbr-selfie/dist/php/enter-box/add_box.php",{quantity:a.quantity,box_value:a.box_partial_value,box_weight:a.box_partial_weight||"NULL",aditional_unit:a.aditional_unit,aditional_value:a.aditional_value,aditional_total:a.aditional_total,box_warehouse_value:a.box_warehouse_value||"NULL",long_desc:a.long_desc||"NULL",real_remaining:parseInt(a.real_remaining)-parseInt(a.quantity),id:a.id,awb_boxes_id:a.awb_boxes_id,created:Math.floor((new Date).getTime())})})},this._addBox=function(a){return t.checkAuth().then(function(t){if(0==t.data.isAdmin)return a.uid=parseInt(t.data.uid),e.post("./hbr-selfie/dist/php/box/add.php",{bill:a.bill,box_stock:a.box_stock,box_value:a.box_value,box_weight:a.box_weight||"NULL",long_desc:a.long_desc,short_desc:a.short_desc,whId:a.whId.id,uid:a.uid,created:Math.floor((new Date).getTime())})})},this._getAllEnterBoxes=function(){return e.get("./hbr-selfie/dist/php/enter-box/get_box.php")},this._editBox=function(a){return t.checkAuth().then(function(t){a.uid=parseInt(t.data.uid);var r=a.whId?a.whId.id:a.warehouse.id,o=parseInt(t.data.isAdmin);return e.post("./hbr-selfie/dist/php/box/edit.php",{id:a.id,bill:a.bill,box_stock:a.box_stock,box_value:a.box_value,box_weight:a.box_weight||"NULL",box_shipping_value:a.box_shipping_value||"NULL",box_warehouse_value:a.box_warehouse_value||"NULL",long_desc:a.long_desc,short_desc:a.short_desc,whId:r,uid:a.uid,edited:Math.floor((new Date).getTime()),status:o,location:a.location||0})})},this._editEnterBox=function(a,r){return t.checkAuth().then(function(t){a.uid=parseInt(t.data.uid);a.whId?a.whId.id:a.warehouse.id,parseInt(t.data.isAdmin);return e.post("./hbr-selfie/dist/php/enter-box/edit_box.php",{quantity:a.quantity,remaining:parseInt(a.remaining)+parseInt(r.quantity)-parseInt(a.quantity),box_value:a.box_partial_value,box_weight:a.box_partial_weight||"NULL",aditional_unit:a.aditional_unit,aditional_value:a.aditional_value,box_warehouse_value:a.box_warehouse_value||"NULL",aditional_total:a.aditional_total,long_desc:a.long_desc||"NULL",id:a.id,awb_boxes_id:a.awb_boxes_id})})},this._finishEnterBox=function(t){return e.post("./hbr-selfie/dist/php/enter-box/finish_box.php",{id:t.id,awb_id:t.awb_boxes_id})},this._deleteBox=function(t){return e.post("./hbr-selfie/dist/php/box/delete.php",{id:t.id})},this._deleteEnterBox=function(t){return e.post("./hbr-selfie/dist/php/enter-box/delete_box.php",{id:t.id,remaining:t.remaining,awb_boxes_id:t.awb_boxes_id})}}t.service("boxService",a),a.$inject=["$http","authenticationService"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this._getLang=function(){var t=parseInt(sessionStorage.getItem("isAdmin"));return e.get("./hbr-selfie/dist/routes/wh-box/awb-box/i18n.json").then(function(e){return 1==t?e.data.en:e.data.es})},this._getAllAwbBoxes=function(){return e.get("./hbr-selfie/dist/php/awb-box/get_box.php")},this._getAwbBoxesByUserId=function(){return t.checkAuth().then(function(t){var a=parseInt(t.data.uid);return e.get("./hbr-selfie/dist/php/awb-box/get_box.php",{params:{uid:a}})})},this._getAwbBoxesById=function(e){},this._deleteBill=function(t){return e.post("./hbr-selfie/dist/php/awb-box/delete_bill.php",{id:t})},this._deleteBill=function(t){return e.post("./hbr-selfie/dist/php/awb-box/delete_bill.php",{id:t.id})},this._addAwbBox=function(a){return t.checkAuth().then(function(t){a.uid=a.uid?a.uid:parseInt(t.data.uid);a.whId?a.whId.id:a.warehouse.id;return e.post("./hbr-selfie/dist/php/awb-box/add_box.php",{tracking:a.tracking,provider:a.provider,stock:parseInt(a.box_stock),box_value:parseFloat(a.box_value),weight:parseFloat(a.box_weight)||"NULL",whId:parseInt(a.whId.id),uid:parseInt(a.uid),created:Math.floor((new Date).getTime())})})},this._editBox=function(a){return t.checkAuth().then(function(t){a.uid=a.uid?a.uid:parseInt(t.data.uid);a.whId?a.whId.id:a.warehouse.id;return e.post("./hbr-selfie/dist/php/awb-box/edit_box.php",{tracking:a.tracking,provider:a.provider,stock:parseInt(a.box_stock),status:parseInt(a.status),id:parseInt(a.id),uid:parseInt(a.uid),box_value:parseFloat(a.box_value),weight:parseFloat(a.box_weight)||"NULL",whId:parseInt(a.whId.id)})})},this._addBills=function(a,r){return t.checkAuth().then(function(t){a.uid=parseInt(t.data.uid),a.boxId=r,a.timestamp=Math.floor((new Date).getTime());var o=new FormData;return angular.forEach(a,function(e,t){o.append(t,e)}),e.post("./hbr-selfie/dist/php/awb-box/add_box_bill.php",o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})})},this._editBill=function(a){return t.checkAuth().then(function(t){a.uid=parseInt(t.data.uid),a.timestamp=Math.floor((new Date).getTime());var r=new FormData;return angular.forEach(a,function(e,t){r.append(t,e)}),e.post("./hbr-selfie/dist/php/awb-box/edit_box_bill.php",r,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})})},this._updateRealValues=function(t){return e.post("./hbr-selfie/dist/php/awb-box/update_real_values.php",{real_box_value:parseFloat(t.real_box_value),real_box_weight:parseFloat(t.real_box_weight),real_remaining:parseInt(t.real_remaining),real_box_stock:parseInt(t.real_box_stock),id:parseInt(t.id)})},this._deleteBox=function(t){return e.post("./hbr-selfie/dist/php/awb-box/delete_box.php",{id:t.id})},this._deleteBill=function(t){return e.post("./hbr-selfie/dist/php/awb-box/delete_bill.php",{id:t.id})}}t.service("awbboxService",a),a.$inject=["$http","authenticationService"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this._getLang=function(){var t=(parseInt(sessionStorage.getItem("isAdmin")),parseInt(sessionStorage.getItem("clientType")),sessionStorage.getItem("lang"));return e.get("./hbr-selfie/dist/routes/wh-box/shipping/i18n.json").then(function(e){return e.data[t]})},this._addShippingBox=function(a){return t.checkAuth().then(function(t){var r=a.boxes[0].warehouse.id,o=a.boxes[0].user.id;return e.post("./hbr-selfie/dist/php/shipping-box/add_box.php",{created:Math.floor((new Date).getTime()),wh_location:r,status:0,uid:o})})},this._deleteBox=function(t){return e.post("./hbr-selfie/dist/php/shipping-box/delete_box.php",{id:t.id,edited:Math.floor((new Date).getTime())})},this._editShippingBox=function(a){a.enter_box[0].warehouse.id;return t.checkAuth().then(function(t){var r={id:a.id,created:a.created||Math.floor((new Date).getTime()),edited:Math.floor((new Date).getTime()),status:a.status,travel_status:a.travel_status,wh_tracking:a.wh_tracking||null,bsas_tracking:a.bsas_tracking||null,wh_provider:a.wh_provider||null,bsas_provider:a.bsas_provider||null,wh_arrival_date:new Date(a.wh_arrival_date).getTime()||null,wh_leave_date:new Date(a.wh_leave_date).getTime()||null,bsas_arrival_date:new Date(a.bsas_arrival_date).getTime()||null,bsas_leave_date:new Date(a.bsas_leave_date).getTime()||null,customer_arrival_date:new Date(a.customer_arrival_date).getTime()||null,bill_file_name:a.bill_file_name||null,bill_file_path:a.bill_file_path||null},o=new FormData;return angular.forEach(r,function(e,t){o.append(t,e)}),e.post("./hbr-selfie/dist/php/shipping-box/edit_box.php",o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})})},this._getAllShippingBox=function(){return e.post("./hbr-selfie/dist/php/shipping-box/get_box.php")},this._getBoxesByUserId=function(){return t.checkAuth().then(function(t){return e.post("./hbr-selfie/dist/php/shipping-box/get_box.php",{uid:t.data.uid})})},this._editTravelStatus=function(t){return e.post("./hbr-selfie/dist/php/shipping-box/edit_travel_status.php",{id:t.id,travel_status:t.travel_status,edited:Math.floor((new Date).getTime())})},this._editWarehouseLocation=function(t){return e.post("./hbr-selfie/dist/php/shipping-box/edit_warehouse_location.php",{id:t.id,warehouse_location:t.warehouse_location.id,wh_arrival_date:new Date(t.wh_arrival_date).getTime()||t.wh_arrival_date||null,wh_leave_date:new Date(t.wh_leave_date).getTime()||t.wh_leave_date||null,wh_tracking:t.wh_tracking||null,wh_provider:t.wh_provider||null,edited:Math.floor((new Date).getTime()),travel_status:t.travel_status})},this._updateEnterBox=function(a){return t.checkAuth().then(function(t){a.uid=parseInt(t.data.uid);a.whId?a.whId.id:a.warehouse.id,parseInt(t.data.isAdmin);return e.post("./hbr-selfie/dist/php/enter-box/edit_box.php",{quantity:a.quantity,remaining:parseInt(a.remaining),box_value:a.box_partial_value,box_weight:a.box_partial_weight||"NULL",aditional_unit:a.aditional_unit,aditional_value:a.aditional_value,box_warehouse_value:a.box_warehouse_value||"NULL",aditional_total:a.aditional_total,long_desc:a.long_desc||"NULL",id:a.id,awb_boxes_id:a.awb_boxes_id,shipping_box_id:a.shipping_box_id})})}}t.service("shippingService",a),a.$inject=["$http","authenticationService"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this.add_warehouse=function(a){t.defer();return e.post("./hbr-selfie/dist/php/warehouse.php",{warehouse_name:a.name,user_name:a.user_name,user_lastname:a.user_lastname,tel:a.tel,cel:a.cel,codeType:"1",idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalcode:a.postalcode,password:a.password,password2:a.password2,client_type:"2",method:"POST"})},this.editWarehouse=function(a){t.defer();return e.put("./hbr-selfie/dist/php/warehouse.php",{id:a.id,warehouse_name:a.name,user_name:a.user_name,user_lastname:a.user_lastname,tel:a.tel,cel:a.cel,codeType:"1",idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalcode:a.postalcode,password:a.password,password2:a.password2,client_type:"2",action:"edit"})},this.deleteWarehouse=function(a){console.log(a.id);t.defer();return e.put("./hbr-selfie/dist/php/warehouse.php",{id:a.id,action:"delete"})}}t.service("warehouseService",a),a.$inject=["$http","$q"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this.get_products=function(a){t.defer();return e.get("./hbr-selfie/dist/php/product.php",{params:{action:"getAll",isPremium:a||""}})},this.get_productsByCategoryId=function(a){t.defer();return e.get("./hbr-selfie/dist/php/product.php",{params:{action:"getByCategoryId",categoryId:a}})},this.add_product=function(a){t.defer();return e.post("./hbr-selfie/dist/php/product.php",{category_id:a.category_id.category_id,product_name:a.name,product_desc:a.description,imp_rights:a.imp_rights,imp_estadistic_rate:a.imp_estadistic_rate,imp_iva:a.imp_iva,imp_iva_adic:a.imp_iva_adic,method:"POST"})},this.edit_product=function(a){t.defer();return e.put("./hbr-selfie/dist/php/product.php",{id:a.id,category_id:a.category_id.category_id,product_name:a.name,product_desc:a.description,imp_rights:a.imp_rights,imp_estadistic_rate:a.imp_estadistic_rate,imp_iva:a.imp_iva,imp_iva_adic:a.imp_iva_adic,action:"edit"})},this.delete_product=function(a){t.defer();return e.put("./hbr-selfie/dist/php/product.php",{id:a.id,action:"delete"})},this.changeprivileges=function(a){t.defer();return e.put("./hbr-selfie/dist/php/product.php",{id:a.id,isPremium:1==a.isPremium?0:1,action:"changeprivileges"})}}t.service("productService",a),a.$inject=["$http","$q"]}e.exports=a},function(e,t){function a(e,t){function a(e,t){this.tutorialChange=function(a){t.defer();return e.put("./hbr-selfie/dist/php/users.php",{id:a,action:"tutorialChange"})},this.adduser=function(a){t.defer();return e.post("./hbr-selfie/dist/php/users.php",{name:a.name,lastname:a.lastname,tel:a.tel,cel:a.cel,codeType:a.codeType.toString(),idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalCode:a.postalCode,password:a.password,password2:a.password2,method:"POST",action:"register"})},this.addcompany=function(a){t.defer();return e.post("./hbr-selfie/dist/php/users.php",{name:a.name,lastname:a.lastname,company_name:a.company_name,company_real_name:a.company_real_name,tel:a.tel,cel:a.cel,codeType:a.codeType.toString(),idCode:a.idCode,email:a.email,address:a.address,localidad:a.localidad,postalCode:a.postalCode,password:a.password,password2:a.password2,method:"POST",action:"register"})},this.editusers=function(a){t.defer();return e.put("./hbr-selfie/dist/php/users.php",{id:a.id,name:a.name,lastname:a.lastname,tel:a.tel,cel:a.cel,codeType:a.codeType,idCode:a.idCode,email:a.email,oldEmail:a.oldEmail,address:a.address,localidad:a.localidad,postalcode:a.postalcode,password:a.password,password2:a.password2,client_type:"2",action:"edit"})},this.deleteusers=function(a){t.defer();return e.put("./hbr-selfie/dist/php/users.php",{id:a.id,action:"delete"})},this.changeRoles=function(a){t.defer();return e.put("./hbr-selfie/dist/php/users.php",{id:a.id,isAdmin:0==a.isAdmin?1:0,action:"changeRoles"})},this.getPremium=function(){return e.get("./hbr-selfie/dist/php/users.php",{params:{action:"getUserBySskey",sskey:sessionStorage.getItem("sskey")||!1}})}}t.service("usersService",a),a.$inject=["$http","$q"]}e.exports=a},function(e,t){function a(e,t){function a(e){this.get_categories=function(){return e.get("./hbr-selfie/dist/php/category.php",{params:{action:"getAll"}})},this.add_category=function(t){return e.post("./hbr-selfie/dist/php/category.php",{category_name:t.name,method:"POST"})},this.edit_category=function(t){return e.put("./hbr-selfie/dist/php/category.php",{category_id:t.category_id,category_name:t.name,action:"edit"})},this.delete_category=function(t){return e.put("./hbr-selfie/dist/php/category.php",{category_id:t.category_id,action:"delete"})}}t.service("categoryService",a),a.$inject=["$http"]}e.exports=a},function(e,t){function a(e,t){function a(t){this.get_airwayBills=function(e,a){return t.get("./hbr-selfie/dist/php/get_airwaybills.php",{params:{action:"getByPurchaseId",ventaId:e,state:a}})},this.get_finished_airwaybills=function(){return t.get("./hbr-selfie/dist/php/get_finished_awb.php",{params:{state:1}})},this.get_finished_airwaybillsByUserId=function(e){return t.get("./hbr-selfie/dist/php/get_finished_awb_by_user.php",{params:{state:2,uid:e}})},this.save=function(a){var r=new FormData,o=[];return e.forEach(a,function(e,t){"products"!==t?r.append(t,e):o=e}),t.post("./hbr-selfie/dist/php/add_guides.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.updateGuide=function(a){var r=new FormData,o=[];return e.forEach(a,function(e,t){"products"!==t?r.append(t,e):o=e}),t.post("./hbr-selfie/dist/php/update_guides.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.addProductToAwb=function(a){var r=new FormData;return e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/add_product_to_guide.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.updateBill=function(a){var r=new FormData;return e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/update_bill.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.updateProduct=function(a){var r=new FormData;return e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/update_product.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.updateVenta=function(a){var r=new FormData;return e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/update_venta.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})}}t.service("airwayService",a),a.$inject=["$http"]}e.exports=a},function(e,t){function a(e,t){"use strict";function a(t,a){this.uploadProducts=function(r,o,i){var n=a.defer();return e.forEach(r,function(a){a.ventaId=o,a.timestamp=i;var r=new FormData;a.weight||(a.weight=0),e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/add_products.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})}),n.promise},this.uploadBills=function(r,o,i,n){a.defer();r.ventaId=o,r.timestamp=n,r.userId=i;var s=new FormData,l=[];return e.forEach(r,function(e,t){"products"!==t&&"warehouse"!==t?s.append(t,e):l=e}),t.post("./hbr-selfie/dist/php/add_bill.php",s,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.uploadProducts=function(r){var o=(a.defer(),new FormData);return e.forEach(r,function(e,t){o.append(t,e)}),t.post("./hbr-selfie/dist/php/add_bill_product.php",o,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.edit_product=function(a){var r=new FormData;return a.categoryId=parseInt(a.category.category_id),e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/edit_product.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})},this.edit_bill=function(a){a.timestamp=(new Date).getTime();var r=new FormData;return e.forEach(a,function(e,t){r.append(t,e)}),t.post("./hbr-selfie/dist/php/edit_bill.php",r,{transformRequest:e.identity,headers:{"Content-Type":void 0}})}}t.service("uploadService",a),a.$inject=["$http","$q"]}e.exports=a},function(e,t){function a(e,t){"use angular template";function a(t,a,r){function o(e,t,r){e.$watch(function(){return sessionStorage.sskey},function(t,r){a.checkAuth().then(function(t){e.showTutorial=t.data.showTutorial}),e.isLogged=sessionStorage.getItem("sskey")||!1,e.lang=sessionStorage.getItem("lang")||"es",e.username=sessionStorage.getItem("username")||"",e.isAdmin=JSON.parse(sessionStorage.getItem("isAdmin"))},!0)}function i(t,r,o){function i(t){r.showSpinner=!0,localStorage.setItem("lang",t),s.lang=t,r.setLang(t).then(function(t){r.langs=t.data,s.lang=r.langs.navbar,s.openLang=!1,e.element("#lang-menu").removeClass("in"),s.langSet=localStorage.getItem("lang")||"es",r.showSpinner=!1})}function n(){r.showSpinner=!0,a.logout().then(function(){r.showSpinner=!1,setTimeout(function(){sessionStorage.clear(),window.location.href="https://tucourier.com.ar/hbr-selfie/"},300)}).error(function(e){console.log(e)})}var s=this;!function(){s.logout=n,s.setLang=i,s.openLang=!1,s.langSet=localStorage.getItem("lang")||"es",t.$watch("$root.langs",function(){s.lang=r.langs.navbar})}()}return{restrict:"E",replace:!0,templateUrl:"./hbr-selfie/dist/components/navbar/navbar.template.html",link:o,controllerAs:"navbar",controller:i}}t.directive("navbar",a),a.$inject=["$state","authenticationService","$rootScope","$window","$uibModalStack"]}e.exports=a},function(e,t){function a(e,t){"use strict";function a(e){return{restrict:"A",link:function(t,a,r){a.on("change",function(o){e(r.uploaderModel).assign(t,a[0].files[0])})}}}t.directive("uploaderModel",a),a.$inject=["$parse"]}e.exports=a},function(e,t){function a(e,t){t.factory("dragContext",[function(){function t(){return e.extend(r,{data:null,reset:t,start:a})}function a(e){return r.data=e,e}var r={};return t()}]),t.run(["$document","$rootElement","$timeout",function(e,t,a){function r(){i()}function o(){i()}function i(){a(function(){t.removeClass("drag-active")})}t[0].addEventListener("dragend",r,!0),t[0].addEventListener("drop",o,!0),function(e,t){t||(t=document);var a=t.head||t.getElementsByTagName("head")[0];if(!a){a=t.createElement("head");var r=t.body||t.getElementsByTagName("body")[0];r?r.parentNode.insertBefore(a,r):t.documentElement.appendChild(a)}var o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),a.appendChild(o)}('.drag-active .drop-container{position:relative}.drag-active .drop-container *{pointer-events:none}.drag-active .drop-container:before{position:absolute;top:0;right:0;bottom:0;left:0;z-index:9999;content:""}',e[0])}]),t.directive("dragContainer",["$rootElement","$parse","$timeout","dragContext",function(e,t,a,r){return{restrict:"A",link:function(o,i,n){function s(t){if(a(function(){e.addClass("drag-active")},0,!1),r.start(n.dragData?o.$eval(n.dragData):i),i.addClass("drag-container-active"),c){var s={$event:t,$dragData:r.data};o.$apply(function(){c(o,s)})}var l=t.originalEvent||t;l.dataTransfer&&(l.dataTransfer.items&&l.dataTransfer.items.length||l.dataTransfer.files&&l.dataTransfer.files.length||l.dataTransfer.setData("text",""))}function l(t){if(a(function(){e.removeClass("drag-active")},0,!1),r.reset(),i.removeClass("drag-container-active"),d){var n={$event:t,$dragData:r.data};o.$apply(function(){d(o,n)})}r.lastTarget&&r.lastTarget.$attrs.$removeClass("drag-over")}var c=n.onDragStart?t(n.onDragStart):null,d=n.onDragEnd?t(n.onDragEnd):null;n.$addClass("drag-container"),o.$watch(n.dragContainer,function(e){n.$set("draggable",void 0===e||e)}),i.on("dragstart",s),i.on("dragend",l)}}}]),t.directive("dropContainer",["$document","$parse","$window","dragContext",function(t,a,r,o){function i(e){return e[0]||e}function n(a){a=i(a);var o=a.getBoundingClientRect();return{width:Math.round(e.isNumber(o.width)?o.width:a.offsetWidth),height:Math.round(e.isNumber(o.height)?o.height:a.offsetHeight),top:Math.round(o.top+(r.pageYOffset||t[0].documentElement.scrollTop)),left:Math.round(o.left+(r.pageXOffset||t[0].documentElement.scrollLeft))}}return{restrict:"A",require:"dropContainer",controller:"DropContainerController",controllerAs:"dropContainer",link:function(t,r,i,s){function l(e){o.lastTarget&&o.lastTarget!==r&&o.lastTarget.$attrs.$removeClass("drag-over"),o.lastTarget={$attrs:i,$element:r};var a={$event:e,$dragData:o.data};p(t,a)&&(e.preventDefault(),i.$addClass("drag-over"),h&&t.$apply(function(){h(t,a)}))}function c(a){var l={$event:a,$dragData:o.data};if(p(t,l)){a.preventDefault();var c=n(r);i.$addClass("drag-over");var d=Number.MAX_VALUE,u=c.width,h=c.height,g=a.pageX-c.left,m=a.pageY-c.top,b=s.lastTarget;e.forEach(s.targets,function(e,t){var a=u/2,r=h/2;t.indexOf("left")>=0&&(a=1*u/4),t.indexOf("top")>=0&&(r=1*h/4),t.indexOf("right")>=0&&(a=3*u/4),t.indexOf("bottom")>=0&&(r=3*h/4);var o=Math.pow(a-g,2)+Math.pow(r-m,2);o<d&&(b=e,d=o)}),t.$apply(function(){f&&f(t,l),b&&(b!==s.lastTarget&&(s.lastTarget&&i.$removeClass("drop-container-"+s.lastTarget.anchor),i.$addClass("drop-container-"+b.anchor),s.lastTarget&&s.lastTarget.handleDragLeave(a,l),b.handleDragEnter(a,l),s.lastTarget=b),b.handleDragOver(a))})}}function d(e){i.$removeClass("drag-over");var a={$event:e,$dragData:o.data};t.$apply(function(){g&&g(t,a),s.lastTarget&&s.lastTarget.handleDragLeave(e,a),s.lastTarget&&(i.$removeClass("drop-container-"+s.lastTarget.anchor),s.lastTarget=null)})}function u(e){o.lastTarget&&o.lastTarget.$attrs.$removeClass("drag-over");var a={$event:e,$dragData:o.data};p(t,a)&&(e.preventDefault(),o.reset(),t.$apply(function(){m&&m(t,a),s.lastTarget&&s.lastTarget.handleDrop(e,a)})),s.lastTarget&&i.$removeClass("drop-container-"+s.lastTarget.anchor),s.lastTarget=null}var p=i.dropAccepts?a(i.dropAccepts):function(e,t){return void 0!==t.$dragData},h=i.onDragEnter?a(i.onDragEnter):null,f=i.onDragOver?a(i.onDragOver):null,g=i.onDragLeave?a(i.onDragLeave):null,m=i.onDrop?a(i.onDrop):null;i.$addClass("drop-container"),r.on("dragover",c),r.on("dragenter",l),r.on("dragleave",d),r.on("drop",u)}}}]),t.controller("DropContainerController",[function(){var e=this,t="center top top-right right bottom-right bottom bottom-left left top-left".split(" ");e.targets={},e.lastTarget=null,e.attach=function(a){var r=a.anchor;if(t.indexOf(r)<0)throw new Error("Invalid drop target anchor `"+r+"`.");return e.targets[r]=a,a},e.detach=function(a){var r=a.anchor;if(t.indexOf(r)<0)throw new Error("Invalid drop target anchor `"+r+"`.");if(!e.targets[r]===a)throw new Error("The indicated drop target is not attached at the anchor `"+r+"`.");return delete e.targets[r],a}}]),t.directive("dropTarget",["$parse","dragContext",function(t,a){return{restrict:"A",require:["^dropContainer","dropTarget"],scope:!0,bindToController:{anchor:"@dropTarget"},controller:e.noop,controllerAs:"dropTarget",link:function(a,r,o,i){var n=i[0],s=i[1];o.$addClass("drop-target"),s.$attrs=o,s.$scope=a,o.$addClass("drop-target drop-target-"+s.anchor),n.attach(s);var l=s.$attrs.onDragEnter?t(s.$attrs.onDragEnter):e.noop,c=s.$attrs.onDragLeave?t(s.$attrs.onDragLeave):e.noop,d=s.$attrs.onDragOver?t(s.$attrs.onDragOver):e.noop,u=s.$attrs.onDrop?t(s.$attrs.onDrop):e.noop;s.handleDragEnter=function(e,t){l(s.$scope,t)},s.handleDragLeave=function(e,t){c(s.$scope,t)},s.handleDragOver=function(e,t){d(s.$scope,t)},s.handleDrop=function(e,t){u(s.$scope,t)},a.$on("$destroy",function(){n.detach(s)})}}}])}e.exports=a}])});