<div class="row">
    <form name="shopping.shoppingForm_purchase" data-ng-submit="shopping.shoppingForm_purchase.$valid && !shopping.shoppingForm_purchase.$pristine && shopping.shoppingForm_purchase.$submitted && shopping.add_bill()">
        <div class="col-xs-12 form-padding">
            <h3>Informaci&oacute;n de la Factura</h3>
            <!-- TIENDA DE COMPRA -->
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="establishment">Tienda de compra (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-shopping-bag"></i></span>
                    <input id="establishment" class="form-control" type="text" name="establishment" ng-model="shopping.bill.establishment" placeholder="Tienda de compra"
                        autocomplete="off" required>
                </div>
            </div>

            <!-- NUMERO DE FACTURA -->
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="bill_number">N&uacute;mero de Factura (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-file-text"></i></span>
                    <input id="bill_number" class="form-control" type="text" name="bill_number" ng-model="shopping.bill.number" placeholder="N&uacute;mero de factura"
                        autocomplete="off" required>
                </div>
            </div>

            <!-- PRESTADOR POSTAL -->
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.postal.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="postal">Prestador Postal (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-truck"></i></span>
                    <input id="postal" class="form-control" type="text" name="postal" ng-model="shopping.bill.provider" placeholder="Nombre del prestador postal"
                        autocomplete="off" required>
                </div>
            </div>

            <!-- NUMERO DE TRACKING -->
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="tracking_number">N&uacute;mero de Tracking de la compra
                        (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-map"></i></span>
                    <input id="tracking_number" class="form-control" type="text" name="tracking_number" ng-model="shopping.bill.tracking_number"
                        placeholder="N&uacute;mero de tracking" autocomplete="off" required>
                </div>
            </div>
            <!-- WAREHOUSE -->
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="warehouses">Warehouse
                        (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-home"></i></span>
                    <select class="form-control" ng-options="warehouse.name for warehouse in shopping.warehouses track by warehouse.id" name="warehouses"
                        id="warehouses" ng-model="shopping.bill.whId">
                        <option value="" disabled="disabled">-- Selecciona un Warehouse --</option>
                        </select>
                </div>
            </div>
            <div class="form-group col-xs-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.bill_file.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label for="bill_file" class="control-label">Agregar Factura ( PDF ) (*)</label>
                <input type="file" name="bill_file" id="bill_file" required ng-model="shopping.bill.bill_file" uploader-model="shopping.bill.bill_file"
                />

            </div>
        </div>
        <div class="col-xs-12">
            <p class="text-danger" ng-if="shopping.bill_error"><i class="fa fa-warning"></i> {{shopping.bill_error}}</p>
        </div>
        <br>
        <div class="col-xs-12">
            <h3>Detalle de la Factura</h3>
            <h4>Agregar Productos</h4>
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="categories">Categor&iacute;a del producto (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-book"></i></span>
                    <select class="form-control" ng-options="category.name for category in shopping.categories track by category.category_id"
                        name="categories" id="categories" ng-model="shopping.aux_product.category" required>
                        <option value="" disabled="disabled">-- Selecciona Categor&iacute;a --</option>
                        </select>
                </div>
                <i class="fa fa-chevron-right" style="position: absolute;top: 40px; left: 319px;"></i>
            </div>


            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="product_name">Producto (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-list-alt"></i></span>
                    <input id="product_name" class="form-control" type="text" name="product_name" ng-model="shopping.aux_product.name" placeholder="Escribe el nombre del producto"
                        autocomplete="off" required>
                </div>
            </div>


            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="quantity">Cantidad (*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><i class="fa fa-shopping-cart"></i></span>
                    <input id="quantity" class="form-control" type="number" name="quantity" ng-model="shopping.aux_product.quantity" placeholder="Cantidad de productos"
                        autocomplete="off" required>
                </div>
            </div>
        </div>
        <div class="col-xs-12 form-padding">
            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="price">Precio (x unidad)(*)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1">U<i class="fa fa-usd"></i>D</span>
                    <input id="price" class="form-control" type="number" step="0.01" name="name" ng-model="shopping.aux_product.price" placeholder="Precio del producto en d&oacute;lares"
                        autocomplete="off" required>
                </div>
            </div>

            <div class="form-group col-xs-12 col-sm-4" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                <label class="control-label" for="weight">Peso en KG. (x unidad)</label><br>
                <div class="input-group">
                    <span class="input-group-addon" id="basic-addon1"><strong>Kg.</strong></span>
                    <input id="weight" class="form-control" type="number" step="0.01" name="weight" ng-model="shopping.aux_product.weight" placeholder="Peso del producto"
                        autocomplete="off">
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 no-padding">
                <div class="form-group col-xs-12 col-sm-3" data-ng-class="{'has-error': shopping.shoppingForm_purchase.name.$invalid && shopping.shoppingForm_purchase.$submitted}">
                    <button type="button" ng-click="shopping.add_product()" ng-disabled="!shopping.aux_product.name || !shopping.aux_product.category || !shopping.aux_product.quantity || !shopping.aux_product.price"
                        class="btn btn-hbr-green" ng-if="!editProduct">Agregar Producto</button>
                    <button type="button" ng-click="shopping.edit_product()" ng-disabled="!shopping.aux_product.name || !shopping.aux_product.category || !shopping.aux_product.quantity || !shopping.aux_product.price"
                        class="btn btn-hbr-green" ng-if="editProduct">Editar Producto</button>
                </div>
                <div class="form-group col-xs-12 col-sm-3">
                    <button type="button" ng-click="shopping.add_bill()" ng-disabled="!shopping.bill.products.length" class="btn btn-hbr-blue" ng-if="!editBill">Terminar Factura</button>
                    <button type="button" ng-click="shopping.edit_bill()" ng-disabled="!shopping.bill.products.length" class="btn btn-hbr-blue" ng-if="editBill">Editar Factura</button>
                </div>
            </div>
            <div class="col-xs-12">
                <p class="text-danger" ng-if="shopping.product_error"><i class="fa fa-warning"></i> {{shopping.product_error}}</p>
            </div>
            <div class="col-xs-12 product-table" ng-if="shopping.bill.products.length">
                <h4>Productos</h4>
                <table class="col-xs-12">
                    <thead>
                        <tr>
                            <td><span>Categor&iacute;a</span></td>
                            <td><span>Producto</span></td>
                            <td><span>Cantidad</span></td>
                            <td><span>Peso</span></td>
                            <td><span>Precio</span></td>
                            <td><span>Peso Total</span></td>
                            <td><span>Precio Total</span></td>
                            <td></td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="product in shopping.bill.products track by $index">
                            <td><span> {{product.category.name}} </span></td>
                            <td><span> {{product.name}} </span></td>
                            <td><span> {{product.quantity}} </span></td>
                            <td><span> {{product.weight}} KG.</span></td>
                            <td><span> {{product.price | currency }} </span></td>
                            <td><span> {{product.total_weight }} KG.</span></td>
                            <td><span> {{product.total_price | currency }} </span></td>
                            <td><span style="color:black; cursor:pointer;margin-right:5px;"><i class="fa fa-edit" ng-click="shopping.showEditProduct(product, $index)"></i></span> <span style="color:red; cursor:pointer;"><i class="fa fa-close" ng-click="shopping.removeProduct(product, $index)"></i></span></td>
                        </tr>
                    </tbody>
                </table>
                <div class="col-xs-12 no-padding">
                    <h5 class="total-factura">Total: {{ shopping.bill.total_price | currency }}</h5>
                </div>
            </div>
        </div>
    </form>
</div>